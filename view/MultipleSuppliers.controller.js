/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.MultipleSuppliers",{onInit:function(){this.supplierBindingPath="";this.oRouter=undefined;this.oBus=sap.ui.getCore().getEventBus();this.oBus.subscribe("ui.s2p.mm.purord.fromrequisition.supplier","path",this.setSupplierList,this);var l=this.byId("supplist");if(l){l.setShowNoData(false)}},onExit:function(){sap.ui.getCore().getEventBus().unsubscribe("ui.s2p.mm.purord.fromrequisition.supplier","path",this.setSupplierList,this)},setSupplierList:function(c,e,d){var l=this.byId("supplist");var L=this.byId("listitem");if(l&&L){l.bindItems(d.path,L)}this.itemPath=d.itempath;this.oBackendModel=d.backendModel;var n=d.itempath.lastIndexOf("/");this.iPRItemIndex=d.itempath.slice(n+1);var t=this.byId("above");if(t&&d.displayText){t.setText(d.displayText)}},onSupplierAssign:function(e){var c=e.getSource().getBindingContext();var p=c.getPath();var P=c.getProperty(p+"/PRSourceKeys");var s=c.getProperty(p+"/FixedVendor");var S=c.getProperty(p+"/FixedVendorName");var o=c.getProperty(p+"/OpenQuantityUnit");var O=c.getProperty(p+"/OpenQuantityUnitDescription");var a=c.getProperty(p+"/OpenQuantity");var b=c.getProperty(p+"/OpenQuantityFormatted");var n=c.getProperty(p+"/NetPrice");var N=c.getProperty(p+"/NetPriceFormatted");var d=c.getProperty(p+"/NetOrderValue");var f=c.getProperty(p+"/NetOrderValueFormatted");var C=c.getProperty(p+"/Currency");var g=c.getProperty(p+"/PriceUnit");var h=c.getProperty(p+"/OrderPriceUnit");var i=c.getProperty(p+"/OrderPriceUnitDescription");var j=c.getProperty(p+"/PurchasingOrg");if(s!==""){var m=this.oView.getModel();var k=m.bindProperty(this.itemPath+"/SupplierId");k.setValue(s);k=m.bindProperty(this.itemPath+"/SupplierName");k.setValue(S);k=m.bindProperty(this.itemPath+"/PRSourceKeys");k.setValue(P);k=m.bindProperty(this.itemPath+"/OpenQuantityUnit");k.setValue(o);k=m.bindProperty(this.itemPath+"/OpenQuantityUnitDescription");k.setValue(O);k=m.bindProperty(this.itemPath+"/OpenQuantity");k.setValue(a);k=m.bindProperty(this.itemPath+"/OpenQuantityFormatted");k.setValue(b);k=m.bindProperty(this.itemPath+"/Price");k.setValue(n);k=m.bindProperty(this.itemPath+"/PriceFormatted");k.setValue(N);k=m.bindProperty(this.itemPath+"/Value");k.setValue(d);k=m.bindProperty(this.itemPath+"/ValueFormatted");k.setValue(f);k=m.bindProperty(this.itemPath+"/Currency");k.setValue(C);k=m.bindProperty(this.itemPath+"/PriceUnit");k.setValue(g);k=m.bindProperty(this.itemPath+"/OrderPriceUnit");k.setValue(h);k=m.bindProperty(this.itemPath+"/OrderPriceUnitDescription");k.setValue(i);k=m.bindProperty(this.itemPath+"/PurchasingOrganization");k.setValue(j);var l=m.getData().PRItemCollection[this.iPRItemIndex];this.oView.getParent().close();sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.popup","selection",{sItemPath:this.itemPath,iPRItemIndex:this.iPRItemIndex,sContextPath:p,oPRItem:l,sOrigin:this.oView.getParent().sOrigin})}else{this.oView.getParent().close()}},onSupplierLink:function(e){var c=e.oSource.getBindingContext();this.oRouter.navTo("supplier",{supplierId:c.getProperty("FixedVendor"),companyCode:c.oModel.getProperty(this.itemPath+"/CompanyCode"),purchasingOrganization:c.getProperty("PurchasingOrg")});this.oView.getParent().close()},formatAssignButton:function(e,d){if(e||d==='L'){return false}else{return true}},formatPriceError:function(e){return(e)?"sap-icon://alert":""}});
