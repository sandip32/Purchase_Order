jQuery.sap.registerPreloadedModules({"name":"ui/s2p/mm/purord/fromrequisition/Component-preload","version":"2.0","modules":{"ui/s2p/mm/purord/fromrequisition/Common.js":function(){
/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("ui.s2p.mm.purord.fromrequisition.Common");jQuery.sap.require("sap.ui.base.Object");jQuery.sap.require("sap.m.Popover");jQuery.sap.require("sap.ca.ui.message.message");sap.ui.base.Object.extend("ui.s2p.mm.purord.fromrequisition.Common",{});ui.s2p.mm.purord.fromrequisition.Common.getSupplierPopup=function(m,i,r){var v=new sap.ui.view({viewName:"ui.s2p.mm.purord.fromrequisition.view.MultipleSuppliers",type:sap.ui.core.mvc.ViewType.XML});v.setModel(m);v.setModel(i,"i18n");v.getController().oRouter=r;var p=new sap.m.Popover({placement:sap.m.PlacementType.Right});p.addContent(v);return p};ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage=function(m,d){var s={message:m,type:sap.ca.ui.message.Type.ERROR};if(d!==""){s.details=d}sap.ca.ui.message.showMessageBox(s)};ui.s2p.mm.purord.fromrequisition.Common.ShowWarningMessage=function(m,d){var s={message:m,type:sap.ca.ui.message.Type.WARNING};if(d!==""){s.details=d};sap.ca.ui.message.showMessageBox(s)};ui.s2p.mm.purord.fromrequisition.Common.getListPopup=function(t,l,s,S,L){var p=new sap.m.Popover({placement:sap.m.PlacementType.Top,title:t});var o=new sap.m.List({mode:"SingleSelectLeft",includeItemInSelection:true});jQuery.each(l,function(k,v){var i=new sap.m.StandardListItem();i.setTitle(v);if(k===s){i.setSelected(true)};o.addItem(i)});o.attachSelect(S,L);p.addContent(o);return p};ui.s2p.mm.purord.fromrequisition.Common.sortList=function(l,s,d){if(!l){return};var S=new sap.ui.model.Sorter(s,d);if(s==="Value"){S.fnCompare=function(a,b){var v=parseFloat(a);var V=parseFloat(b);if(v<V)return-1;if(v>V)return 1;return 0}};var L=l.getBinding("items");if(L)L.sort(S)}},"ui/s2p/mm/purord/fromrequisition/Component.js":function(){jQuery.sap.declare("ui.s2p.mm.purord.fromrequisition.Component");jQuery.sap.require("sap.ui.core.UIComponent");jQuery.sap.require("sap.ca.scfld.md.ConfigurationBase");jQuery.sap.require("sap.ca.scfld.md.ComponentBase");jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.Configuration");jQuery.sap.require("sap.ui.core.routing.Router");jQuery.sap.require("sap.ui.core.routing.History");jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.Common");sap.ca.scfld.md.ComponentBase.extend("ui.s2p.mm.purord.fromrequisition.Component",{metadata:sap.ca.scfld.md.ComponentBase.createMetaData("FS",{"name":"Fullscreen Sample","version":"1.0.0","library":"ui.s2p.mm.purord.fromrequisition","includes":["css/app.css"],"dependencies":{"libs":["sap.m","sap.me"],"components":[],},"config":{"resourceBundle":"i18n/i18n.properties","titleResource":"FULLSCREEN_TITLE","icon":"sap-icon://expense-report","favIcon":"./resources/sap/ca/ui/themes/base/img/favicon/Order_From_Requisitions.ico","homeScreenIconPhone":"./resources/sap/ca/ui/themes/base/img/launchicon/Order_From_Requisitions/57_iPhone_Desktop_Launch.png","homeScreenIconPhone@2":"./resources/sap/ca/ui/themes/base/img/launchicon/Order_From_Requisitions/114_iPhone-Retina_Web_Clip.png","homeScreenIconTablet":"./resources/sap/ca/ui/themes/base/img/launchicon/Order_From_Requisitions/72_iPad_Desktop_Launch.png","homeScreenIconTablet@2":"./resources/sap/ca/ui/themes/base/img/launchicon/Order_From_Requisitions/144_iPad_Retina_Web_Clip.png"},viewPath:"ui.s2p.mm.purord.fromrequisition.view",fullScreenPageRoutes:{"fullscreen":{pattern:"",view:"POfromPR"},"pr_Item":{pattern:"pr_Item/{prKey}",view:"FS_PR_Item"},"supplier":{pattern:"supplier/{supplierId}/{companyCode}/{purchasingOrganization}",view:"FS_Supplier"}}}),createContent:function(){var v={component:this};return sap.ui.view({viewName:"ui.s2p.mm.purord.fromrequisition.Main",type:sap.ui.core.mvc.ViewType.XML,viewData:v})},})},"ui/s2p/mm/purord/fromrequisition/Configuration.js":function(){jQuery.sap.declare("ui.s2p.mm.purord.fromrequisition.Configuration");jQuery.sap.require("sap.ca.scfld.md.ConfigurationBase");jQuery.sap.require("sap.ca.scfld.md.app.Application");sap.ca.scfld.md.ConfigurationBase.extend("ui.s2p.mm.purord.fromrequisition.Configuration",{oServiceParams:{serviceList:[{name:"SRA013_PO_FROM_PR_SRV",masterCollection:"PRItemCollection",serviceUrl:"/sap/opu/odata/sap/SRA013_PO_FROM_PR_SRV/",isDefault:true,mockedDataSource:"/ui.s2p.mm.purord.fromrequisition/model/metadata.xml",noBusyIndicator:false}]},getServiceParams:function(){return this.oServiceParams},getServiceList:function(){return this.oServiceParams.serviceList},getMasterKeyAttributes:function(){return["Id"]}})},"ui/s2p/mm/purord/fromrequisition/Main.controller.js":function(){sap.ui.controller("ui.s2p.mm.purord.fromrequisition.Main",{onInit:function(){jQuery.sap.require("sap.ca.scfld.md.Startup");sap.ca.scfld.md.Startup.init('ui.s2p.mm.purord.fromrequisition',this)},onExit:function(){if(sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.PO_Simulated").oParams.oModel)sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.PO_Simulated").oParams.oModel=null;if(sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.PO_Created").oParams.oModel)sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.PO_Created").oParams.oModel=null}})},"ui/s2p/mm/purord/fromrequisition/Main.view.xml":'<!--\r\n\r\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\r\n\r\n-->\r\n<core:View xmlns:core     = "sap.ui.core"\r\n           xmlns          = "sap.m" \r\n           controllerName = "ui.s2p.mm.purord.fromrequisition.Main"\r\n           displayBlock   = "true" \r\n           height         = "100%">\r\n\t<App id="fioriContent">\r\n\t</App>\r\n</core:View>',"ui/s2p/mm/purord/fromrequisition/util/Formatter.js":function(){jQuery.sap.declare("ui.s2p.mm.purord.fromrequisition.util.Formatter");jQuery.sap.require("sap.ui.core.format.DateFormat");jQuery.sap.require("sap.ui.core.format.NumberFormat");jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.Common");jQuery.sap.require("sap.ca.ui.model.format.NumberFormat");jQuery.sap.require("sap.ca.ui.model.format.AmountFormat");ui.s2p.mm.purord.fromrequisition.util.Formatter={oBundle:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle(),formatPRItem:function(p,P){return p+"-"+P},formatAmount:function(v,c){return sap.ca.ui.model.format.AmountFormat.FormatAmountStandard(v,c)},formatDateShort:function(d){var D=sap.ui.core.format.DateFormat.getDateInstance({style:"short"},sap.ui.getCore().getConfiguration().getLocale());if(typeof d==='string'){d=new Date(d)}if(d instanceof Date){return D.format(d)}else{return""}},formatDateLong:function(d){var D=sap.ui.core.format.DateFormat.getDateInstance({style:"long"},sap.ui.getCore().getConfiguration().getLocale());if(typeof d==='string'){d=new Date(d)}if(d instanceof Date){return D.format(d)}else{return""}},formatItemDesc:function(d,i){if(i==null||i=="")return d;else return d+" ("+i+")"},formatMatQuantity:function(o,a){var m="";m=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatNumber(o)+" "+a;return m},formatUnitPrice:function(p,c,a,o){var u="";if(p===""){return ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.PR_List.no_price")}return u=(a==="1")?ui.s2p.mm.purord.fromrequisition.util.Formatter.formatNumber(p)+" "+c+" / "+o:ui.s2p.mm.purord.fromrequisition.util.Formatter.formatNumber(p)+" "+c+" / "+a+" "+o},formatUnitPriceL:function(p,c,a,o){var u=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatUnitPrice(p,c,a,o);if(u){var l=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.unit_price");return l+": "+u}},formatIncoterms:function(i,a){var I="";if(i){I=i;if(a){I=I+" - "+a}}return I},formatIncotermsL:function(i,a){var I=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatIncoterms(i,a);var l=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.inco_terms");if(I)return l+": "+I},formatPaymentTerms:function(C,a,b,c,d,P){if(P===undefined){var D=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.days");var s=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.daysnet");return C+" "+D+" "+a+" %, "+b+" "+D+" "+c+" %, "+d+" "+s}else{return P}},formatPaymentTermsL:function(C,a,b,c,d,P){var p=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPaymentTerms(C,a,b,c,d,P);if(p){var l=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.payment_terms");return l+": "+p}},formatSource:function(A,a,I,D){var t;if(A!==""&&a!=""){switch(D){case"K":t=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.source_contract");return t+" "+A+"-"+a;break;case"L":t=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSupplier.source_schedagree");return t+" "+A+"-"+a;break}}else if(A===""&&I!=""){t=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.source_inforec");return t+" "+I}else if(A===""&&I===""){return t=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.PO_List.supplier")}},formatSourceL:function(A,a,I,D){var s=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatSource(A,a,I,D);var l=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSuppliers.source");if(s)return l+": "+s},formatErrorMessageDocCategory:function(D){return(D==='L')?ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.MultipleSupplier.source_schedagree_mess"):""},formatReceiptSettlement:function(r){if(r==="X"){return ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.POfromPR.yes")}},formatSupplierStatus:function(O,C,a,b){if(O==="X"||C==="X"||a==="X"||b==="X"){return ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.Supplier_Factsheet.Blocked")}else{return ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.Supplier_Factsheet.Active")}},formatNumber:function(n){return sap.ui.core.format.NumberFormat.getFloatInstance().format(n)},lazyFormatNumber:function(n){if(n)if(!isNaN(parseFloat(n))&&isFinite(n))if(Math.abs(n)<1e6)return sap.ui.core.format.NumberFormat.getFloatInstance().format(n);else return sap.ca.ui.model.format.NumberFormat.getInstance({style:'short'}).format(n);return""},formatQuantityandUnit:function(q,u){return sap.ui.core.format.NumberFormat.getFloatInstance().format(q)+" "+u},formatPricePerUnit:function(p,c,P,s){var u;if(p===""){u=ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("view.PR_List.no_price")}else{u=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatNumber(p)+" "+c+" "+ui.s2p.mm.purord.fromrequisition.util.Formatter.oBundle.getText("fs.pritem.per")+" "+P+" "+s}return u}}},"ui/s2p/mm/purord/fromrequisition/view/FS_PR_Item.controller.js":function(){jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.util.Formatter");jQuery.sap.require("sap.ca.ui.utils.busydialog");sap.ca.scfld.md.controller.BaseFullscreenController.extend("ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item",{oParams:{},onInit:function(e){sap.ca.scfld.md.controller.BaseFullscreenController.prototype.onInit.call(this);this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="pr_Item"){this.sCallerId=this.oParams.sCallerId;this.oList=this.oParams.oList;if(this.sCallerId){this.byId("btnPreviousPRItem").setVisible(true);this.byId("btnNextPRItem").setVisible(true);this.oModel=sap.ui.getCore().byId(this.sCallerId).getModel("PR_appr_model");if(!this.oModel){this.oModel=sap.ui.getCore().byId(this.sCallerId).getModel("PR_ass_model")}this.iNumberOfItems=this.oModel.getProperty("/PRItemCollection").length;this.ReadLocalData()}else{this.byId("btnPreviousPRItem").setVisible(false);this.byId("btnNextPRItem").setVisible(false);sap.ca.ui.utils.busydialog.requireBusyDialog();this.getView().getModel().read("/PRItemCollection('"+e.getParameter("arguments").prKey+"')",null,null,true,jQuery.proxy(this.onOdataReadSuccess,this),jQuery.proxy(this.onOdataReadError,this))}}},this)},onOdataReadError:function(e){sap.ca.ui.utils.busydialog.releaseBusyDialog();var m=this.oApplicationImplementation.getResourceBundle().getText('view.POfromPR.general_error_unassigned_message');var d="";if(e.message&&e.response){d=e.message+"\n"+e.response.requestUri+"\n"+e.response.statusText}ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage(m,d)},onOdataReadSuccess:function(d){sap.ca.ui.utils.busydialog.releaseBusyDialog();var m=new sap.ui.model.json.JSONModel(d);this.getView().setModel(m,"PR_item_model")},ReadLocalData:function(){var p=this.oParams.sPath?("/"+this.oParams.sPath.split("/")[1]+"/"):undefined;var c=this.oParams.sPath?(this.oParams.sPath.split(p)[1]):undefined;var m=new sap.ui.model.json.JSONModel();m.setData(this.oModel.getProperty(p+c));this.getView().setModel(m,"PR_item_model");},getPreviousItem:function(c){var i=(this.oList.indexOf(parseInt(c))-1>=0?this.oList.indexOf(parseInt(c))-1:this.oList.indexOf(parseInt(c)));return this.oList[i]},getNextItem:function(c){var i=(this.oList.indexOf(parseInt(c))+1<this.oList.length?this.oList.indexOf(parseInt(c))+1:this.oList.indexOf(parseInt(c)));return this.oList[i]},getIndexInListFromIndexInModel:function(c){if(this.oList)return this.oList.indexOf(parseInt(c));return-1},onOtherPRItem:function(e){var p=this.oParams.sPath?("/"+this.oParams.sPath.split("/")[1]+"/"):undefined;var c=this.oParams.sPath?(this.oParams.sPath.split(p)[1]):undefined;var i=this.getIndexInListFromIndexInModel(c);var o;var P;if(e.getSource()==this.oView.byId("btnPreviousPRItem")){if(i!=-1){if(i>"0"){o=p+this.getPreviousItem(c);P=this.oModel.getProperty(o);this.oParams.sPath=o;this.oRouter.navTo("pr_Item",{prKey:P.PRKey},true)}}}else if(e.getSource()==this.oView.byId("btnNextPRItem")){if(i!=-1){if(i<this.iNumberOfItems-1){o=p+this.getNextItem(c);P=this.oModel.getProperty(o);this.oParams.sPath=o;this.oRouter.navTo("pr_Item",{prKey:P.PRKey},true)}}}},onBack:function(){var h=sap.ui.core.routing.History.getInstance();var d=h.getDirection("");if(d===sap.ui.core.routing.HistoryDirection.Unknown){this.oRouter.navTo("fullscreen",{})}else{window.history.go(-1)}},onSupplierLink:function(e){var m=this.getView().getModel("PR_item_model");this.oRouter.navTo("supplier",{supplierId:m.getProperty("/SupplierId"),companyCode:m.getProperty("/CompanyCode"),purchasingOrganization:m.getProperty("/PurchasingOrganization")})},formatSupplierOrPlant:function(s,p){return(s)?s:p}})},"ui/s2p/mm/purord/fromrequisition/view/FS_PR_Item.view.xml":'<!--\n\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\n\n-->\n<core:View\txmlns:core="sap.ui.core" \n\t\t\txmlns="sap.m"\n\t\t\txmlns:form="sap.ui.layout.form" \n\t\t\txmlns:layout="sap.ui.layout"\n\t\t\txmlns:me="sap.me"\n\t\t\tcontrollerName="ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item">\n\t<Page id="pg_FS_PR_Item" \n\t\t  class="sapUiFioriObjectPage">\n\t\n        <customHeader>\n            <Bar>\n                <contentLeft>\n                    <Button press="onBack" icon="sap-icon://nav-back"></Button>\n                </contentLeft>\n                <contentMiddle>\n                    <Label text="{i18n>fs.pritem.title}"></Label>\n                </contentMiddle>\n                <contentRight> \n                \t<Button id="btnPreviousPRItem" icon="sap-icon://up"  press="onOtherPRItem"></Button>\n                \t<Button id="btnNextPRItem"     icon="sap-icon://down" press="onOtherPRItem"></Button>\n                </contentRight>\n            </Bar>\n        </customHeader>\n        \n        <content>\n            <ObjectHeader \n            \ttitle="{parts:[{path:\'PR_item_model>/PRNumberFormatted\'},{path:\'PR_item_model>/PRItemFormatted\'}], formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPRItem\'}"\n                number="{path:\'PR_item_model>/Value\', formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatNumber\'}"\n                numberUnit="{PR_item_model>/Currency}">\n                <attributes>\n                    <ObjectAttribute text="{PR_item_model>/ProductDescription}"> </ObjectAttribute>\n                </attributes>\n            </ObjectHeader>\n\n\t\t\t\t\t<form:Form>\n\t\t\t\t\t\t<form:layout>\n\t\t\t\t\t\t\t<form:ResponsiveLayout></form:ResponsiveLayout>\n\t\t\t\t\t\t</form:layout>\n\t\t\t\t\t\t<form:formContainers>\n\t\t\t\t\t\t\t<form:FormContainer>\n\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t</form:layoutData>\n\n\t\t\t\t\t\t\t\t<form:formElements>\n\t\t\t\t\t\t\t\t\t<!-- Requested by -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>view.PR_Factsheet.requestor}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{PR_item_model>/RequestedByUserName}">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Material -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>view.PR_List.column_mat}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{parts:[{path : \'PR_item_model>/ProductDescription\'},{path: \'PR_item_model>/ProductID\'}], \n\t\t\t\t\t\t\t\t\t\t\t             formatter : \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatItemDesc\'}">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Quantity -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>view.PO_List.quantity}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{parts:[{path : \'PR_item_model>/OpenQuantityFormatted\'},{path: \'PR_item_model>/OpenQuantityUnitDescription\'}], \n\t\t\t\t\t\t\t\t\t\t\t             formatter : \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatQuantityandUnit\'}">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Price per unit -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>fs.pritem.price_per_unit}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{parts:[{path:\'PR_item_model>/Price\'},{path:\'PR_item_model>/Currency\'},{path:\'PR_item_model>/PriceUnit\'},{path:\'PR_item_model>/OrderPriceUnitDescription\'}], \n\t\t\t\t\t\t\t\t\t\t\t            formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPricePerUnit\'}">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Material Group -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>view.PR_Factsheet.mat_group}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{parts:[{path : \'PR_item_model>/MaterialGroupDescription\'},{path: \'PR_item_model>/MaterialGroup\'}], \n\t\t\t\t\t\t\t\t\t\t\t             formatter : \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatItemDesc\'}">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Delivery on -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>fs.pritem.delivery_on}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{path:\'PR_item_model>/DeliveryDate\', formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatDateLong\' }">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Delivery to -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>fs.pritem.delivery_to}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{PR_item_model>/DeliveryAddressFormatted}" maxLines="0">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Plant -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>view.PO_List.plant}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Text text="{parts:[{path : \'PR_item_model>/ShipToPlantDescription1\'},{path: \'PR_item_model>/ShipToPlant\'}], \n\t\t\t\t\t\t\t\t\t\t\t             formatter : \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatItemDesc\'}">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData weight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t\t<!-- Supplier or Supplying Plant -->\n\t\t\t\t\t\t\t\t\t<form:FormElement>\n\t\t\t\t\t\t\t\t\t\t<form:layoutData>\n\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData\n\t\t\t\t\t\t\t\t\t\t\t\tlinebreak="true" margin="false"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t</form:layoutData>\n\t\t\t\t\t\t\t\t\t\t<form:label>\n\t\t\t\t\t\t\t\t\t\t\t<Label text="{i18n>view.PO_List.supplier}"></Label>\n\t\t\t\t\t\t\t\t\t\t</form:label>\n\t\t\t\t\t\t\t\t\t\t<form:fields>\n\t\t\t\t\t\t\t\t\t\t\t<Link id="lnkSupplier" press="onSupplierLink" \n\t\t\t\t\t\t\t\t\t\t\t    text="{parts:[{path:\'PR_item_model>/SupplierName\'},{path:\'PR_item_model>/SupplyingPlantDescription\'}], formatter : \'.formatSupplierOrPlant\'}">\n\t\t\t\t\t\t\t\t\t\t\t\t<layoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<layout:ResponsiveFlowLayoutData weight="2"></layout:ResponsiveFlowLayoutData>\n\t\t\t\t\t\t\t\t\t\t\t\t</layoutData>\n\t\t\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t\t\t</form:fields>\n\t\t\t\t\t\t\t\t\t</form:FormElement>\n\n\t\t\t\t\t\t\t\t</form:formElements>\n\n\t\t\t\t\t\t\t</form:FormContainer>\n\n\t\t\t\t\t\t</form:formContainers>\n\t\t\t\t\t</form:Form>\n        </content>\n\n\t</Page>\n</core:View>',"ui/s2p/mm/purord/fromrequisition/view/FS_Supplier.controller.js":function(){jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");sap.ca.scfld.md.controller.BaseFullscreenController.extend("ui.s2p.mm.purord.fromrequisition.view.FS_Supplier",{onInit:function(e){this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="supplier"){this.getView().getModel().read("SupplierInfoCollection(VendorId='"+e.getParameter("arguments").supplierId+"',CompanyCode='"+e.getParameter("arguments").companyCode+"',PurchasingOrganization='"+e.getParameter("arguments").purchasingOrganization+"')",null,["$expand=SupplierContactCollection"],true,jQuery.proxy(this.onOdataReadSuccess,this))}},this)},onOdataReadSuccess:function(d){var m=new sap.ui.model.json.JSONModel(d);if(this.extHookOnDataReceived){m=this.extHookOnDataReceived(m)}this.getView().setModel(m,"supplier_model")},onBack:function(){var h=sap.ui.core.routing.History.getInstance();var d=h.getDirection("");if(d===sap.ui.core.routing.HistoryDirection.Unknown){this.oRouter.navTo("fullscreen",{})}else{window.history.go(-1)}},onTapPhone:function(e){sap.m.URLHelper.triggerTel(e.getSource().getText())},onTapEmail:function(e){sap.m.URLHelper.triggerEmail(e.getSource().getText())},onTapWebsite:function(e){var s=e.getSource().getText();s=s.replace(/^\s+|\s+$/g,"");var i=s.search("http");if(i!==0){s="http://"+s}sap.m.URLHelper.redirect(s,true)}})},"ui/s2p/mm/purord/fromrequisition/view/FS_Supplier.view.xml":'<!--\r\n\r\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\r\n\r\n-->\r\n<core:View xmlns:core="sap.ui.core" xmlns="sap.m"\r\n\txmlns:form="sap.ui.layout.form"\r\n\tcontrollerName="ui.s2p.mm.purord.fromrequisition.view.FS_Supplier">\r\n\t<Page id="FS_Supplier_Page"\r\n\t\t  class="sapUiFioriObjectPage">\r\n\r\n\t\t<customHeader>\r\n\t\t\t<Bar>\r\n\t\t\t\t<contentLeft>\r\n\t\t\t\t\t<Button press="onBack" icon="sap-icon://nav-back"></Button>\r\n\t\t\t\t</contentLeft>\r\n\t\t\t\t<contentMiddle>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.header}"></Label>\r\n\t\t\t\t</contentMiddle>\r\n\t\t\t</Bar>\r\n\t\t</customHeader>\r\n\r\n\t\t<content>\r\n\r\n\t\t\t<ObjectHeader title="{supplier_model>/VendorName}">\r\n\t\t\t\t<attributes>\r\n\t\t\t\t\t<ObjectAttribute text="{supplier_model>/Address}"></ObjectAttribute>\r\n\t\t\t\t\t<!-- @ExtensionPoint supplier details: header -->\r\n\t\t\t\t\t<core:ExtensionPoint name="supplierDetailsHeader" />\r\n\t\t\t\t</attributes>\r\n\t\t\t</ObjectHeader>\r\n\r\n\t\t\t<!-- Contact Contact Info -->\r\n\t\t\t<form:SimpleForm id="ContactInfo" minWidth="1024" editable="false"\r\n\t\t\t\tlabelMinWidth="-1" maxContainerCols="2">\r\n\t\t\t\t<form:content>\r\n\t\t\t\t<!-- \t<core:Title text="{i18n_c>XTIT_BC_CONTACTINFO}"></core:Title> -->\r\n\t\t\t\t\t<core:Title text="{i18n>XTIT_BC_CONTACTINFO}"></core:Title>\t\t\t\t\t\r\n\t\t\t\t<!-- \t<Label text="{i18n_c>XTIT_BC_SupplierContact}"> -->\r\n\t\t\t\t\t<Label text="{i18n>XTIT_BC_SupplierContact}">\t\t\t\t\t\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text text="{supplier_model>/SupplierContactCollection/results/0/ContactName}">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.phone}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Link id="bcContactPhone" press="onTapPhone"\r\n\t\t\t\t\t\ttext="{supplier_model>/SupplierContactCollection/results/0/WorkPhone}">\r\n\t\t\t\t\t</Link>\r\n\t\t\t<!-- \t\t<Label text="{i18n_c>XFLD_BC_MOBILE}"> -->\r\n\t\t\t\t\t<Label text="{i18n>XFLD_BC_MOBILE}">\t\t\t\t\t\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Link id="bcContactMobile" press="onTapPhone"\r\n\t\t\t\t\t\ttext="{supplier_model>/SupplierContactCollection/results/0/MobilePhone}">\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.fax}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text text="{supplier_model>/Fax}">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.website}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Link press="onTapWebsite" text="{supplier_model>/Url}">\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.Mail}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Link press="onTapEmail" text="{supplier_model>/SupplierContactCollection/results/0/Email}">\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<!-- @ExtensionPoint supplier details: contact details -->\r\n\t\t\t\t\t<core:ExtensionPoint name="supplierDetailsContact" />\r\n\t\t\t\t</form:content>\r\n\t\t\t</form:SimpleForm>\r\n\t\t\t<!-- Supplier Details -->\r\n\t\t\t<form:SimpleForm id="SupplierDetail" minWidth="1024" editable="false">\r\n\t\t\t\t<form:content>\r\n\t\t\t\t\t<core:Title text="{i18n>view.Supplier_Factsheet.header}"></core:Title>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.CustID}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text text="{supplier_model>/OurAccountWithVendor}" maxLines="0">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.class}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text text="{supplier_model>/ABCIndicator}" maxLines="0">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.Industry}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text text="{supplier_model>/IndustryDescription}" maxLines="0">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.Status}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text id="SupplierStatus"\r\n\t\t\t\t\t\ttext="{parts:[ {path:\'supplier_model>/OrgPurchasingBlock\'},{path:\'supplier_model>/CentralPurchasingBlock\'},\r\n\t\t\t\t\t\t\t{path:\'supplier_model>/CentralPostingBlock\'},{path:\'supplier_model>/CompanyPostingBlock\'}],\r\n\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatSupplierStatus\' }">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<!-- @ExtensionPoint supplier details: supplier data -->\r\n\t\t\t\t\t<core:ExtensionPoint name="supplierDetailsData" />\r\n\t\t\t\t</form:content>\r\n\t\t\t</form:SimpleForm>\r\n\t\t\t<!-- Purchasing Data -->\r\n\t\t\t<form:SimpleForm id="PurchasingData" minWidth="1024" editable="false">\r\n\t\t\t\t<form:content>\r\n\t\t\t\t\t<core:Title text="{i18n>view.Supplier_Factsheet.Purch_header}"></core:Title>\r\n\t\t\t\t\t<Label text="{i18n>view.MultipleSuppliers.payment_terms}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text id="payment"\r\n\t\t\t\t\t\ttext="{parts:[ {path:\'supplier_model>/CashDiscountDays1\'},{path:\'supplier_model>/CashDiscountPercentage1\'},\r\n\t\t\t\t\t\t\t{path:\'supplier_model>/CashDiscountDays2\'},{path:\'supplier_model>/CashDiscountPercentage2\'}, \r\n\t\t\t\t\t\t\t{path:\'supplier_model>/CashDiscountDays2\'}, {path:\'supplier_model>/PaymentTermsDescription\'}],\r\n\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPaymentTerms\' }">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.MultipleSuppliers.inco_terms}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text\r\n\t\t\t\t\t\ttext="{parts:[ {path:\'supplier_model>/Incoterms1\'},{path:\'supplier_model>/Incoterms2\'} ],\r\n\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatIncoterms\' }">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.Min_Purch_Val}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text\r\n\t\t\t\t\t\ttext="{path:\'supplier_model>/MinimumOrderValue\', formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatNumber\'}">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<Label text="{i18n>view.Supplier_Factsheet.receipt_settle}">\r\n\t\t\t\t\t</Label>\r\n\t\t\t\t\t<Text\r\n\t\t\t\t\t\ttext="{parts:[ {path:\'supplier_model>/EvaluatedReceiptSettlement\'} ],\r\n\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatReceiptSettlement\' }">\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t\t<!-- @ExtensionPoint supplier details: purchasing data -->\r\n\t\t\t\t\t<core:ExtensionPoint name="supplierDetailsPurData" />\r\n\t\t\t\t</form:content>\r\n\t\t\t</form:SimpleForm>\r\n\r\n\t\t\t<!-- @ExtensionPoint supplier details: additional customer data -->\r\n\t\t\t<core:ExtensionPoint name="supplierDetailsAddData" />\r\n\t\t</content>\r\n\t</Page>\r\n</core:View>',"ui/s2p/mm/purord/fromrequisition/view/MultipleSuppliers.controller.js":function(){sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.MultipleSuppliers",{onInit:function(){this.supplierBindingPath="";this.oRouter=undefined;this.oBus=sap.ui.getCore().getEventBus();this.oBus.subscribe("ui.s2p.mm.purord.fromrequisition.supplier","path",this.setSupplierList,this);var l=this.byId("supplist");if(l){l.setShowNoData(false)}},onExit:function(){sap.ui.getCore().getEventBus().unsubscribe("ui.s2p.mm.purord.fromrequisition.supplier","path",this.setSupplierList,this)},setSupplierList:function(c,e,d){var l=this.byId("supplist");var L=this.byId("listitem");if(l&&L){l.bindItems(d.path,L)}this.itemPath=d.itempath;this.oBackendModel=d.backendModel;var n=d.itempath.lastIndexOf("/");this.iPRItemIndex=d.itempath.slice(n+1);var t=this.byId("above");if(t&&d.displayText){t.setText(d.displayText)}},onSupplierAssign:function(e){var c=e.getSource().getBindingContext();var p=c.getPath();var P=c.getProperty(p+"/PRSourceKeys");var s=c.getProperty(p+"/FixedVendor");var S=c.getProperty(p+"/FixedVendorName");var o=c.getProperty(p+"/OpenQuantityUnit");var O=c.getProperty(p+"/OpenQuantityUnitDescription");var a=c.getProperty(p+"/OpenQuantity");var b=c.getProperty(p+"/OpenQuantityFormatted");var n=c.getProperty(p+"/NetPrice");var N=c.getProperty(p+"/NetPriceFormatted");var d=c.getProperty(p+"/NetOrderValue");var f=c.getProperty(p+"/NetOrderValueFormatted");var C=c.getProperty(p+"/Currency");var g=c.getProperty(p+"/PriceUnit");var h=c.getProperty(p+"/OrderPriceUnit");var i=c.getProperty(p+"/OrderPriceUnitDescription");var j=c.getProperty(p+"/PurchasingOrg");if(s!==""){var m=this.oView.getModel();var k=m.bindProperty(this.itemPath+"/SupplierId");k.setValue(s);k=m.bindProperty(this.itemPath+"/SupplierName");k.setValue(S);k=m.bindProperty(this.itemPath+"/PRSourceKeys");k.setValue(P);k=m.bindProperty(this.itemPath+"/OpenQuantityUnit");k.setValue(o);k=m.bindProperty(this.itemPath+"/OpenQuantityUnitDescription");k.setValue(O);k=m.bindProperty(this.itemPath+"/OpenQuantity");k.setValue(a);k=m.bindProperty(this.itemPath+"/OpenQuantityFormatted");k.setValue(b);k=m.bindProperty(this.itemPath+"/Price");k.setValue(n);k=m.bindProperty(this.itemPath+"/PriceFormatted");k.setValue(N);k=m.bindProperty(this.itemPath+"/Value");k.setValue(d);k=m.bindProperty(this.itemPath+"/ValueFormatted");k.setValue(f);k=m.bindProperty(this.itemPath+"/Currency");k.setValue(C);k=m.bindProperty(this.itemPath+"/PriceUnit");k.setValue(g);k=m.bindProperty(this.itemPath+"/OrderPriceUnit");k.setValue(h);k=m.bindProperty(this.itemPath+"/OrderPriceUnitDescription");k.setValue(i);k=m.bindProperty(this.itemPath+"/PurchasingOrganization");k.setValue(j);var l=m.getData().PRItemCollection[this.iPRItemIndex];this.oView.getParent().close();sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.popup","selection",{sItemPath:this.itemPath,iPRItemIndex:this.iPRItemIndex,sContextPath:p,oPRItem:l,sOrigin:this.oView.getParent().sOrigin})}else{this.oView.getParent().close()}},onSupplierLink:function(e){var c=e.oSource.getBindingContext();this.oRouter.navTo("supplier",{supplierId:c.getProperty("FixedVendor"),companyCode:c.oModel.getProperty(this.itemPath+"/CompanyCode"),purchasingOrganization:c.getProperty("PurchasingOrg")});this.oView.getParent().close()},formatAssignButton:function(e,d){if(e||d==='L'){return false}else{return true}},formatPriceError:function(e){return(e)?"sap-icon://alert":""}})},"ui/s2p/mm/purord/fromrequisition/view/MultipleSuppliers.view.xml":'<!--\r\n\r\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\r\n\r\n-->\r\n<core:View\txmlns:core="sap.ui.core"\r\n\t\t\tcontrollerName="ui.s2p.mm.purord.fromrequisition.view.MultipleSuppliers"\r\n\t\t\txmlns="sap.m" \r\n\t\t\txmlns:layout="sap.ui.layout">\r\n\t<layout:VerticalLayout class="sapMContainerMargin">\r\n\t\t<layout:content>\r\n\t\t\t<Text id="above" text="{i18n>view.MultipleSuppliers.title}">\r\n\t\t\t</Text>\r\n\t\t</layout:content>\r\n\t</layout:VerticalLayout>\r\n\r\n\t<List id="supplist"\r\n\t       items="{/}"\r\n\t       visible="true"\r\n\t       mode="None">\r\n\t\t<items>\r\n\t\t\t<CustomListItem id="listitem">\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<ObjectHeader title="{FixedVendorName}" introActive="false"\r\n\t\t\t\t\t\ttitleActive="false" iconActive="false"\r\n\t\t\t\t\t\tnumber="{path:\'NetOrderValue\', formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatNumber\'}"\r\n\t\t\t\t\t\tunit="{Currency}">\r\n\t\t\t\t\t\t<statuses>\r\n\t\t\t\t\t\t\t<ObjectStatus icon="{path: \'Error\', formatter: \'.formatPriceError\'}"\r\n\t\t\t\t\t\t\t\tstate="Error"></ObjectStatus>\r\n\t\t\t\t\t\t</statuses>\r\n\t\t\t\t\t\t<attributes>\r\n\t\t\t\t\t\t\t<ObjectAttribute\r\n\t\t\t\t\t\t\t\ttext="{parts:[ {path:\'NetPrice\'}, {path:\'Currency\'}, {path:\'PriceUnit\'},\r\n\t\t\t\t\t\t\t\t\t{path:\'OrderPriceUnitDescription\'}],\r\n\t\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatUnitPriceL\' }">\r\n\t\t\t\t\t\t\t</ObjectAttribute>\r\n\t\t\t\t\t\t\t<ObjectAttribute\r\n\t\t\t\t\t\t\t\ttext="{parts:[ {path:\'CashDiscountDays1\'},{path:\'CashDiscountPercentage1\'},{path:\'CashDiscountDays2\'},\r\n\t\t\t\t\t\t\t\t\t{path:\'CashDiscountPercentage2\'} ,{path:\'CashDiscountDays2\'}, {path:\'PaymentTermsDescription\'}],\r\n\t\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPaymentTermsL\' }">\r\n\t\t\t\t\t\t\t</ObjectAttribute>\r\n\t\t\t\t\t\t\t<ObjectAttribute\r\n\t\t\t\t\t\t\t\ttext="{parts:[ {path:\'Incoterms1\'},{path:\'Incoterms2\'} ],\r\n\t\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatIncotermsL\' }">\r\n\t\t\t\t\t\t\t</ObjectAttribute>\r\n\r\n\t\t\t\t\t\t\t<ObjectAttribute\r\n\t\t\t\t\t\t\t\ttext="{parts: [ {path: \'Agreement\'}, {path: \'AgreementItem\'}, {path: \'InfoRecord\'}, {path: \'DocumentCategory\'}],\r\n\t\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatSourceL\' }">\r\n\t\t\t\t\t\t\t</ObjectAttribute>\r\n\t\t\t\t\t\t\t<ObjectAttribute\r\n\t\t\t\t\t\t\t\ttext="{path: \'DocumentCategory\',\r\n\t\t\t\t\t\t\t\t\tformatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatErrorMessageDocCategory\' }">\r\n\t\t\t\t\t\t\t</ObjectAttribute>\r\n\t\t\t\t\t\t</attributes>\r\n\r\n\t\t\t\t\t</ObjectHeader>\r\n\r\n\t\t\t\t\t<layout:HorizontalLayout class="sapMContainerMargin">\r\n\t\t\t\t\t\t<layout:content>\r\n\t\t\t\t\t\t\t<Button text="{i18n>view.POfromPR.assign_tit}" press="onSupplierAssign"\r\n\t\t\t\t\t\t\t\tenabled="{parts: [{path:\'Error\'}, {path: \'DocumentCategory\'}], formatter: \'.formatAssignButton\'}">\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button text="{i18n>view.POfromPR_Messages.show_details}"\r\n\t\t\t\t\t\t\t\tpress="onSupplierLink">\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</layout:content>\r\n\t\t\t\t\t</layout:HorizontalLayout>\r\n\r\n\t\t\t\t</content>\r\n\t\t\t</CustomListItem>\r\n\t\t</items>\r\n\t</List>\r\n</core:View>',"ui/s2p/mm/purord/fromrequisition/view/PO_Created.controller.js":function(){jQuery.sap.require("sap.ca.ui.model.format.QuantityFormat");jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");sap.ui.core.mvc.Controller.extend("ui.s2p.mm.purord.fromrequisition.view.PO_Created",{oParams:{},onInit:function(){this.oBundle=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle();this.sStatusSaved=this.oBundle.getText("view.POfromPR_Status.saved");this.sStatusSent=this.oBundle.getText("view.POfromPR_Status.sent");this.sPO=this.oBundle.getText("view.PO_List.po_id");this.sSupplier=this.oBundle.getText("view.PO_List.supplier");this.sTotal=this.oBundle.getText("view.PO_List.total");this.sTitle=this.oBundle.getText("view.POfromPR.sort_tit");this.oList=this.byId("PO_Created_List");this.bResponderOn=jQuery.sap.getUriParameters().get("responderOn");this.sPathToMockFile="/ui.s2p.mm.purord.fromrequisition/mock/createdPurchaseOrders.json";if(this.bResponderOn){this.oBackendModel=new sap.ui.model.json.JSONModel();this.oBackendModel.loadData(this.sPathToMockFile,"",false);if(this.oList){this.oList.setModel(this.oBackendModel)}this.renderPOs(this.oBackendModel)}},renderPOs:function(p){var l=[];if(!this.oList){return};l=this.oList.getItems();$.each(l,jQuery.proxy(function(a,b){var L=new sap.ui.layout.VerticalLayout();var c=new sap.ui.layout.VerticalLayout();var d=new sap.ui.layout.VerticalLayout();var P=p.getData().results[a];var s=undefined;var S=undefined;if(P.StatusId==2){S=this.sStatusSaved;jQuery.sap.log.info("status saved")}else if(P.StatusId==2){S=this.sStatusSent}else if(P.StatusId==3){S=this.sStatusSent;s=sap.ui.core.ValueState.Success}var o=new sap.m.ObjectStatus({text:S,state:s});var t=new sap.m.ObjectNumber({number:ui.s2p.mm.purord.fromrequisition.util.Formatter.lazyFormatNumber(P.Value),unit:P.Currency});d.addContent(t);d.addContent(o);$.each(p.getData().results[a].POItem.results,function(i,v){var D=new sap.m.Text({text:v.ProductDescription});var q=new sap.m.Text({text:sap.ca.ui.model.format.QuantityFormat.getInstance().format(v.QuantityFormatted)+" "+v.QtyUnitDescription,align:"End"});L.addContent(D);c.addContent(q)});l[a].insertCell(L,2);l[a].insertCell(c,3);l[a].insertCell(d,4)},this))},getList:function(){return this.byId("PO_Created_List")},onBeforeRendering:function(){if(!this.bResponderOn){this.oBackendModel=this.oParams.oModel}if(this.oList){this.oList.setModel(this.oBackendModel,"savedPOs")}this.renderPOs(this.oBackendModel)},getVSDialogSort:function(){var t=this;if(t.oVSDialog){return t.oVSDialog}var v=new sap.m.ViewSettingsDialog({sortItems:[new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PO_List.po_id"),key:"PoNumber",selected:true}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PO_List.supplier"),key:"SupplierName"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PO_List.total"),key:"Value"}),],confirm:function(e){var p=e.getParameters();var i=t.oBackendModel.getData().results;var d=p.sortDescending;var s=p.sortItem.getKey();switch(s){case"PoNumber":if(!d){i.sort(function(a,b){if(a.PONumberFormatted<b.PONumberFormatted){return-1}if(a.PONumberFormatted>b.PONumberFormatted){return 1}return 0})}else{i.sort(function(a,b){if(a.PONumberFormatted<b.PONumberFormatted){return 1}if(a.PONumberFormatted>b.PONumberFormatted){return-1}return 0})}break;case"SupplierName":if(!d){i.sort(function(a,b){if(a.SupplierName<b.SupplierName){return-1}if(a.SupplierName>b.SupplierName){return 1}return 0})}else{i.sort(function(a,b){if(a.SupplierName<b.SupplierName){return 1}if(a.SupplierName>b.SupplierName){return-1}return 0})}break;case"Value":if(!d){i.sort(function(a,b){var V=parseFloat(a.Value);var c=parseFloat(b.Value);if(V<c){return-1}if(V>c){return 1}return 0})}else{i.sort(function(a,b){var V=parseFloat(a.Value);var c=parseFloat(b.Value);if(V<c){return 1}if(V>c){return-1}return 0})}break}if(t.oList){t.oList.setModel(null);t.oList.setModel(this.oBackendModel,"savedPOs")}t.onBeforeRendering()},});t.oVSDialog=v;return v}})},"ui/s2p/mm/purord/fromrequisition/view/PO_Created.view.xml":'<!--\n\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\n\n-->\n<core:View xmlns:core="sap.ui.core" xmlns="sap.m"\n\t controllerName="ui.s2p.mm.purord.fromrequisition.view.PO_Created">\n\n\t<!-- purchase requisition list with assigned suppliers -->\n\t<Table id="PO_Created_List" items="{savedPOs>/results}" inset="false"\n\t\tnoDataText="{i18n>view.PO_Created.no_data}">\n\t\t<!-- Columns -->\n\t\t<columns>\n\t\t\t<!-- Purchase Order Number -->\n\t\t\t<Column id="po_id" width="14%">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label1" text="{i18n>view.PO_List.po_id}" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Supplier -->\n\t\t\t<Column id="supplier" demandPopin="false">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label2" text="{i18n>view.PO_List.supplier}"\n\t\t\t\t\t\twrapping="true" ></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Line Items -->\n\t\t\t<Column id="line_items">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label3" text="{i18n>view.PO_List.line_items}"\n\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Line Items Quantity -->\n\t\t\t<Column id="quantity" width="15%" hAlign="End">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label4" text="{i18n>view.PO_List.quantity}"\n\t\t\t\t\t\ttextAlign="End" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Total -->\n\t\t\t<Column id="Total" hAlign="End">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label5" text="{i18n>view.PO_List.total}" textAlign="End"\n\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t</columns>\n\t\t<!-- Column list item -->\n        <items>\n            <ColumnListItem id="list_item" type="Inactive">\n                <cells>\n                    <ObjectIdentifier title="{savedPOs>PONumberFormatted}" text="{savedPOs>text}" badgeNotes="false" badgePeople="false" badgeAttachments="false"></ObjectIdentifier>\n                    <Text text="{savedPOs>SupplierName}"></Text>\n                </cells>\n            </ColumnListItem>\n        </items>\t\t\n\t</Table>\n</core:View>',"ui/s2p/mm/purord/fromrequisition/view/PO_Simulated.controller.js":function(){jQuery.sap.require("sap.ca.ui.model.format.QuantityFormat");jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");jQuery.sap.require("sap.ca.ui.utils.busydialog");sap.ui.core.mvc.Controller.extend("ui.s2p.mm.purord.fromrequisition.view.PO_Simulated",{oParams:{},onInit:function(){this.oBundle=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle();this.sPO=this.oBundle.getText("view.PO_List.po_id");this.sSupplier=this.oBundle.getText("view.PO_List.supplier");this.sTotal=this.oBundle.getText("view.PO_List.total");this.sTitle=this.oBundle.getText("view.POfromPR.sort_tit");this.sSaving=this.oBundle.getText("view.POfromPR.creating_message");this.bResponderOn=jQuery.sap.getUriParameters().get("responderOn");this.oList=this.byId("PO_Simulated_List");this.sPathToMockFile="/ui.s2p.mm.purord.fromrequisition/mock/PurchaseOrders.json";this.oMockModel=undefined;this.oBackendModel=undefined;this.bFirstCall=true;this.poCreatedTotal=0;this.oOldSavedPOsModel=undefined;if(this.bResponderOn){this.oBackendModel=new sap.ui.model.json.JSONModel();this.oBackendModel.loadData(this.sPathToMockFile,"",false);if(this.oList){this.oList.setModel(this.oBackendModel)}}},onBeforeRendering:function(){var l=[];var L;if(!this.bResponderOn){this.oBackendModel=this.oParams.oModel}if(!this.oList){return}this.oList.setModel(this.oBackendModel,"simulatedPOs");l=this.oList.getItems();L=this.oList.getModel("simulatedPOs");if(l[0]&&l[0].getCells().length===3){$.each(this.oList.getItems(),function(a,b){var c=new sap.ui.layout.VerticalLayout();var d=new sap.ui.layout.VerticalLayout();$.each(L.getData().results[a].POProposalItemCollection.results,function(i,v){var D=new sap.m.Text({text:v.ProductDescription});var q=new sap.m.Text({text:sap.ca.ui.model.format.QuantityFormat.getInstance().format(v.QuantityFormatted)+" "+v.QtyUnitDescription});q.setTextAlign("End");c.addContent(D);d.addContent(q)});l[a].insertCell(c,2);l[a].insertCell(d,3)})}if(this.bFirstCall){l=this.oList.getItems();for(var i=0;i<l.length;i++){l[i].setSelected(true)}this.bFirstCall=false}},successSavePO:function(d,r){sap.ca.ui.utils.busydialog.releaseBusyDialog();var p=[];var P=[];var a=[];var I=0;for(I=0;I<d.PO.results.length;++I){if(d.PO.results[I].Error==""){p.push(d.PO.results[I].PONumber);a.push(d.PO.results[I].PRSourceKeys)}else{P.push(I)}}jQuery.sap.log.info("PO saved:"+p);if(P.length>0){var n=[];for(I=0;I<d.PO.results.length;++I){if(d.PO.results[I].Error==""){n.push(d.PO.results[I])}}d.PO.results=n}if(p.length>0){this.poCreatedTotal+=p.length;sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_pocreated:this.poCreatedTotal})}var m="";if(p.length==1){m=this.oBundle.getText("view.POfromPR_Messages.save_sing")}else if(p.length>1){m=this.oBundle.getText("view.POfromPR_Messages.save_plu",[p.length])}var M="";if(P.length==1){M=this.oBundle.getText("view.POfromPR_Messages.save_failed_sing")}else if(P.length>1){M=this.oBundle.getText("view.POfromPR_Messages.save_failed_plu",[P.length])}var s=m+"\n"+M;jQuery.sap.require("sap.m.MessageToast");sap.m.MessageToast.show(s,{width:"30em",duration:6000});if(p.length>0){var S=new sap.ui.model.json.JSONModel();if(this.oOldSavedPOsModel!=null){jQuery.merge(d.PO.results,this.oOldSavedPOsModel.oData.results)}S.setData(d.PO);this.oOldSavedPOsModel=S;sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.PO_Created").oParams.oModel=S;jQuery.sap.log.info("Success saving POs");var t=this.oBackendModel.getData();for(I=t.results.length-1;I>=0;I--){for(var b=0;b<a.length;++b){if(t.results[I].PRSourceKeys==a[b]){t.results.splice(I,1);a.splice(b,1);break}}}for(var c=0;c<a.length;++c){for(b=t.results.length-1;b>=0;b--){var T=t.results[b].PRSourceKeys.split(",");var e=a[c].split(",");for(var f=0;f<e.length;++f){var g=T.indexOf(e[f]);if(g!==-1){T.splice(g,1);t.results[b].PRSourceKeys=T.toString();t.results[b].Value-=t.results[b].POProposalItemCollection.results[g].NetValue;t.results[b].POProposalItemCollection.results.splice(g,1)}}break}}if(this.oList){this.oBackendModel.refresh();this.oList.setModel(null);this.oList.setModel(this.oBackendModel,"simulatedPOs");var l=this.oList.getItems();var L=this.oList.getModel("simulatedPOs");$.each(this.oList.getItems(),function(h,j){var k;var o;if(l[h].getCells().length===3){k=new sap.ui.layout.VerticalLayout();o=new sap.ui.layout.VerticalLayout()}else{k=l[h].getCells()[2];o=l[h].getCells()[3];k.removeAllContent();o.removeAllContent()}$.each(L.getData().results[h].POProposalItemCollection.results,function(i,v){var D=new sap.m.Text({text:v.ProductDescription});var q=new sap.m.Text({text:sap.ca.ui.model.format.QuantityFormat.getInstance().format(v.QuantityFormatted)+" "+v.QtyUnitDescription});q.setTextAlign("End");k.addContent(D);o.addContent(q)});if(l[h].getCells().length===3){l[h].insertCell(k,2);l[h].insertCell(o,3)}})}this.poSimulatedCount=this.oBackendModel.getData().results.length;sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_posimulated:this.poSimulatedCount,});if(this.poSimulatedCount>0&&P.length>1){sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPOsimulatedColor:sap.ui.core.IconColor.Negative})}else{sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPOsimulatedColor:sap.ui.core.IconColor.Default})}}},errorSavePO:function(e){sap.ca.ui.utils.busydialog.releaseBusyDialog();var m=this.oBundle.getText('view.POfromPR.general_error_create_message');var d="";if(e.message&&e.response){d=e.message+"\n"+e.response.requestUri+"\n"+e.response.statusText}ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage(m,d)},postSavePO:function(){this.oBackendODataModel.create("POContainerCollection",this.POContainer,undefined,jQuery.proxy(this.successSavePO,this),jQuery.proxy(this.errorSavePO,this))},onSavePOs:function(){var p=undefined;var P=[];var I=[];if(this.oList){I=this.oList.getSelectedItems()}for(var i=0;i<I.length;i++){var c=I[i].getBindingContext("simulatedPOs");var k=c.getProperty("PRSourceKeys");P.push(k)}if(P.length>0){p=P.join(",");var a="00000";var b="0";var S="0";var d="0";var e="0";var f="0";var C="0";var g="0";var h="0";var j="0.000";var l="0.000";var m="0";var n="0";var V="0.00";var o="0,00";var q="0";var r="0";var E="X";var s="00000";var t="0";var u="0";var v="0";var w="0";var x="0";var y="0";var z="0";var A="0";var B="0";var D="0";var F="0";var G="0";var H="0";var J="0";var K="0";var L="0";var M="0";var N="0";var O="0";var Q="0";var R="0";var T="0";var U="0";var W="0";var X="0";var Y="0";var Z=" ";this.POContainer={POContainerKey:"X",PO:[{POKey:a,PRSourceKeys:p,PONumberFormatted:b,SupplierId:S,SupplierName:d,PurchOrg:e,PaymentTerms:f,CashDiscountDays1:C,CashDiscountDays2:g,CashDiscountDays3:h,CashDiscountPerc1:j,CashDiscountPerc2:l,Incoterms1:m,Incoterms2:n,Value:V,ValueFormatted:o,Currency:q,StatusId:r,Error:E,POItem:[{POKey:s,PONumber:t,POItem:u,PONumberFormatted:v,POItemFormatted:w,PRKey:x,AssignedPRNumber:y,AssignedPRItem:z,ProductId:A,ProductDescription:B,ProductGroup:D,ProductGroupDescr:F,ShipToPlantId:G,ShipToPlantDescr1:H,ShipToPlantDescr2:J,Quantity:K,QuantityFormatted:L,QtyUnit:M,QtyUnitDescription:N,Currency:O,NetPrice:Q,NetPriceFormatted:T,PriceUnit:U,NetValue:R,NetValueFormatted:T,OrderPriceUnit:U,OrderPriceUnitDescr:W,DeliveryDate:X,RequisitionedBy:Y,Error:Z}]}]};if(!this.bResponderOn){sap.ca.ui.utils.busydialog.requireBusyDialog({text:this.sSaving});this.oBackendODataModel=this.oView.getModel("backendModel");this.oBackendODataModel.refreshSecurityToken(jQuery.proxy(this.postSavePO,this),function(_){sap.ca.ui.utils.busydialog.releaseBusyDialog();ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage("error refresh csrf token",_)},true)}}},getList:function(){return this.byId("PO_Simulated_List")},getVSDialogSort:function(){var t=this;if(t.oVSDialog){return t.oVSDialog}var v=new sap.m.ViewSettingsDialog({sortItems:[new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PO_List.po_id"),key:"PoNumber",selected:true}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PO_List.supplier"),key:"SupplierName"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PO_List.total"),key:"Value"}),],confirm:function(e){var p=e.getParameters();var i=t.oBackendModel.getData().results;var d=p.sortDescending;var s=p.sortItem.getKey();switch(s){case"PoNumber":if(!d){i.sort(function(a,b){if(a.PONumberFormatted<b.PONumberFormatted){return-1}if(a.PONumberFormatted>b.PONumberFormatted){return 1}return 0})}else{i.sort(function(a,b){if(a.PONumberFormatted<b.PONumberFormatted){return 1}if(a.PONumberFormatted>b.PONumberFormatted){return-1}return 0})}break;case"SupplierName":if(!d){i.sort(function(a,b){if(a.SupplierName<b.SupplierName){return-1}if(a.SupplierName>b.SupplierName){return 1}return 0})}else{i.sort(function(a,b){if(a.SupplierName<b.SupplierName){return 1}if(a.SupplierName>b.SupplierName){return-1}return 0})}break;case"Value":if(!d){i.sort(function(a,b){var V=parseFloat(a.Value);var c=parseFloat(b.Value);if(V<c){return-1}if(V>c){return 1}return 0})}else{i.sort(function(a,b){var V=parseFloat(a.Value);var c=parseFloat(b.Value);if(V<c){return 1}if(V>c){return-1}return 0})}break}if(t.oList){t.oList.setModel(null);t.oList.setModel(this.oBackendModel,"simulatedPOs")}t.onBeforeRendering()},});t.oVSDialog=v;return v}})},"ui/s2p/mm/purord/fromrequisition/view/PO_Simulated.view.xml":'<!--\n\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\n\n-->\n<core:View xmlns:core="sap.ui.core" xmlns="sap.m"\n\t controllerName="ui.s2p.mm.purord.fromrequisition.view.PO_Simulated">\n\n\t<!-- Purchase order list -->\n\t<Table id="PO_Simulated_List" mode="MultiSelect" items="{simulatedPOs>/results}"\n\t\tnoDataText="{i18n>view.PO_List.no_data}">\n\t\t<!-- Columns -->\n\t\t<columns>\n\t\t\t<!-- Purchase Order Number -->\n\t\t\t<Column id="po_id" width="7%">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label1" text="{i18n>view.PO_List.po_id}" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Supplier -->\n\t\t\t<Column id="supplier">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label2" text="{i18n>view.PO_List.supplier}" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Line Items -->\n\t\t\t<Column id="line_items">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label3" text="{i18n>view.PO_List.line_items}"\twrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Line Items Quantity -->\n\t\t\t<Column id="quantity" width="15%" hAlign="End">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label4" text="{i18n>view.PO_List.quantity}"\n\t\t\t\t\t\ttextAlign="End" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Total -->\n\t\t\t<Column id="Total" hAlign="End">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="label5" text="{i18n>view.PO_List.total}" textAlign="End"\n\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t</columns>\n\t\t<!-- Column list item -->\n\t\t<items>\n\t\t\t<ColumnListItem id="list_item" type="Inactive">\n\t\t\t\t<cells>\n\t\t\t\t\t<ObjectIdentifier title="{simulatedPOs>PONumberFormatted}" text="{simulatedPOs>text}" badgeNotes="false" badgePeople="false" badgeAttachments="false"></ObjectIdentifier>\n\t\t\t\t\t<Text text="{simulatedPOs>SupplierName}"></Text>\n \t\t\t\t\t<ObjectNumber\n \t\t\t\t\t\tnumber="{parts:[{path:\'simulatedPOs>Value\'},{path:\'simulatedPOs>Currency\'}], formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatAmount\'}"\n\t\t\t\t\t\tunit="{simulatedPOs>Currency}">\n\t\t\t\t\t</ObjectNumber>\n\t\t\t\t</cells>\n\t\t\t</ColumnListItem>\n\t\t</items>\t\n\t</Table>\n</core:View>',"ui/s2p/mm/purord/fromrequisition/view/POfromPR.controller.js":function(){jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.util.Formatter");jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.Common");sap.ca.scfld.md.controller.BaseFullscreenController.extend("ui.s2p.mm.purord.fromrequisition.view.POfromPR",{onInit:function(){var s="/sap/opu/odata/sap/SRA013_PO_FROM_PR_SRV";this.oBackendModel=undefined;this.oScrollContHeight=null;if(!jQuery.sap.getUriParameters().get("responderOn")){this.oBackendModel=this.loadBackendModel(s)}this.PRReleasedView=this.oView.byId("ui.s2p.mm.purord.fromrequisition.PR_Released_View");if(this.oBackendModel!==undefined){this.PRReleasedView.setModel(this.oBackendModel,"backendModel")}this.PRAssignedView=sap.ui.xmlview({viewName:"ui.s2p.mm.purord.fromrequisition.view.PR_Assigned"});if(this.oBackendModel!==undefined){this.PRAssignedView.setModel(this.oBackendModel,"backendModel")}this.CurrentView=this.PRReleasedView;var b=sap.ui.getCore().getEventBus();b.subscribe("ui.s2p.mm.purord.fromrequisition.publish","count",this.updateNumber,this);this.oHomeButton=this.byId("HomeButton");if(this.oHomeButton){jQuery.sap.getUriParameters().get("backToHome")?this.oHomeButton.setVisible(true):this.oHomeButton.setVisible(false)}this.HomeUrl=document.referrer;b.subscribe("ui.s2p.mm.purord.fromrequisition.publish","orientationChange",this.onOrientationChange,this);b.subscribe("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",this.updateIconizedFilterColor,this);this.setLocalHeaderFooterOptions()},onExit:function(){var b=sap.ui.getCore().getEventBus();if(this.PRReleasedView){b.unsubscribe("ui.s2p.mm.purord.fromrequisition.popup","selection",this.PRReleasedView.getController().receiveSelection,this.PRReleasedView.getController());b.unsubscribe("ui.s2p.mm.purord.fromrequisition.publish","count",this.PRReleasedView.getController().updateButtonText,this.PRReleasedView.getController());this.PRReleasedView.destroy()};if(this.PRAssignedView){b.unsubscribe("ui.s2p.mm.purord.fromrequisition.trigger","loadAssignedPRs",this.PRAssignedView.getController().loadAssignedPRs,this.PRAssignedView.getController());b.unsubscribe("ui.s2p.mm.purord.fromrequisition.publish","assignedPRs",this.PRAssignedView.getController().receiveAssignedPRs,this.PRAssignedView.getController());b.unsubscribe("ui.s2p.mm.purord.fromrequisition.publish","assignedBackendPRs",this.PRAssignedView.getController().receiveAssBackendPRs,this.PRAssignedView.getController());b.unsubscribe("ui.s2p.mm.purord.fromrequisition.popup","selection",this.PRAssignedView.getController().receiveSelection,this);this.PRAssignedView.destroy()}if(this.POSimulatedView){this.POSimulatedView.destroy()}if(this.POCreatedView){this.POCreatedView.destroy()}b.unsubscribe("ui.s2p.mm.purord.fromrequisition.publish","count",this.updateNumber,this);b.unsubscribe("ui.s2p.mm.purord.fromrequisition.publish","orientationChange",this.onOrientationChange,this);b.unsubscribe("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",this.updateIconizedFilterColor,this)},onBeforeRendering:function(){this.onOrientationChange()},onOrientationChange:function(){var i=this.byId("IconizedFilter");var p=this.byId("PR_Released_Bar");if(!i||!p){return}var f=$(i.getContent()[0].getDomRef());var t=$(p.getDomRef());var a=f.offset();var b=t.offset();if(b!=null&&a!=null){this.oScrollContHeight=b.top-a.top-16;var s=this.byId("ScrollCont");if(s){s.setHeight(this.oScrollContHeight+"px")}}},onHome:function(e){window.history.back()},loadBackendModel:function(s){var m=this.oConnectionManager.getModel();if(!m){var u=this.getODataUrlPrefix()+s;m=new sap.ui.model.odata.ODataModel(u,true)}return m},getODataUrlPrefix:function(){var p=jQuery.sap.getUriParameters().get("proxyOn");if(p=="true"){return"proxy"}else{return""}},onAssignSupplier:function(e){if(this.PRReleasedView){var c=this.PRReleasedView.getController();if(c&&c.onAssignSupplier){jQuery.proxy(c.onAssignSupplier,c)()}}},onCreatePOSimulated:function(e){if(this.PRAssignedView){var c=this.PRAssignedView.getController();if(c&&c.onCreatePOSimulated){jQuery.proxy(c.onCreatePOSimulated,c)()}}},onSave:function(e){jQuery.sap.log.info("Save PO");if(!this.POSimulatedView){this.POSimulatedView=sap.ui.xmlview({viewName:"ui.s2p.mm.purord.fromrequisition.view.PO_Simulated"})}var c=this.POSimulatedView.getController();if(c&&c.onSavePOs){jQuery.proxy(c.onSavePOs,c)()}},switchView:function(e){var s=this.byId("ScrollCont");if(!s){return}if(this.oScrollContHeight!=null){s.setHeight(this.oScrollContHeight+"px")}var k=e.getParameter("selectedKey");if(k=="Released"){if(this.CurrentView!=this.PRReleasedView){s.removeAllContent();s.addContent(this.PRReleasedView);this.CurrentView=this.PRReleasedView}}else if(k=="Assigned"){if(this.CurrentView!=this.PRAssignedView){s.removeAllContent();s.addContent(this.PRAssignedView);this.CurrentView=this.PRAssignedView}}else if(k=="Simulated"){if(!this.POSimulatedView){this.POSimulatedView=sap.ui.xmlview({viewName:"ui.s2p.mm.purord.fromrequisition.view.PO_Simulated"});if(this.oBackendModel!==undefined){this.POSimulatedView.setModel(this.oBackendModel,"backendModel")}}s.removeAllContent();s.addContent(this.POSimulatedView);this.CurrentView=this.POSimulatedView}else if(k=="Created"){if(!this.POCreatedView){this.POCreatedView=sap.ui.xmlview({viewName:"ui.s2p.mm.purord.fromrequisition.view.PO_Created"});if(this.oBackendModel!==undefined){this.POCreatedView.setModel(this.oBackendModel,"backendModel")}}s.removeAllContent();s.addContent(this.POCreatedView);this.CurrentView=this.POCreatedView}this.setLocalHeaderFooterOptions(e)},updateIconizedFilterColor:function(c,e,d){var i;if(d.btnPRreleasedColor){i=this.byId("btnPRreleased");if(i){i.setIconColor(d.btnPRreleasedColor)}}if(d.btnPRassignedColor){i=this.byId("btnPRassigned");if(i){i.setIconColor(d.btnPRassignedColor)}}if(d.btnPOsimulatedColor){i=this.byId("btnPOsimulated");if(i){i.setIconColor(d.btnPOsimulatedColor)}}if(d.btnPOcreatedColor){i=this.byId("btnPOcreated");if(i){i.setIconColor(d.btnPOcreatedColor)}}},updateNumber:function(c,e,d){var i;var C;if(d.count_prapproved){i=this.byId("btnPRreleased");if(i){i.setCount(d.count_loaded+" / "+d.count_prapproved)}}if(d.count_prassigned){i=this.byId("btnPRassigned");if(i){if(d.count_loaded===undefined){i.setCount(d.count_prassigned)}else{i.setCount(d.count_loaded+" / "+d.count_prassigned)}}}if(d.count_posimulated>=0){i=this.byId("btnPOsimulated");if(i){i.setCount(d.count_posimulated)}}if(d.decreaseCount_posimulated){i=this.byId("btnPOsimulated");if(i){C=i.getCount();C-=d.decreaseCount_posimulated;i.setCount(C)}}if(d.count_pocreated){i=this.byId("btnPOcreated");if(i){i.setCount(d.count_pocreated)}}},setLocalHeaderFooterOptions:function(e){var t=this;var c={};var v={};var V={};var k="";var o={};if(t.CurrentView){c=t.CurrentView.getController()}if(!c){return}if(c.getVSDialogSort){v=c.getVSDialogSort()}if(!v){return}if(e){k=e.getParameter("selectedKey")}switch(k){case"":case"Released":if(c.getVSDialogFilter){V=c.getVSDialogFilter()}if(!V){return}o={oSortOptions:{onSortPressed:function(a){v.open()}},oFilterOptions:{onFilterPressed:function(a){V.open()}},oEditBtn:{sI18nBtnTxt:"view.POfromPR.assign_tit",onBtnPressed:function(a){t.onAssignSupplier(e)},},};break;case"Assigned":o={oSortOptions:{onSortPressed:function(a){v.open()}},oEditBtn:{sI18nBtnTxt:"view.POfromPR.simulate_pos",onBtnPressed:function(a){t.onCreatePOSimulated(e)},},};break;case"Simulated":o={oSortOptions:{onSortPressed:function(a){v.open()}},oEditBtn:{sI18nBtnTxt:"view.PO_List.save",onBtnPressed:function(a){t.onSave(e)},},};break;case"Created":o={oSortOptions:{onSortPressed:function(a){v.open()}},};break}t.setHeaderFooterOptions(o)}})},"ui/s2p/mm/purord/fromrequisition/view/POfromPR.view.xml":'<!--\n\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\n\n-->\n<core:View xmlns:core="sap.ui.core" xmlns="sap.m"     xmlns:core.mvc="sap.ui.core.mvc"\n\tcontrollerName="ui.s2p.mm.purord.fromrequisition.view.POfromPR">\n\t<Page id="POfromPR_Page" title="{i18n>FULLSCREEN_TITLE}"\n\t\tenableScrolling="true">\n\t\t\n\t\t<customHeader>\n\t\t\t<Bar id="HeaderBar">\n\t\t\t\t<contentLeft>\n\t\t\t\t\t<Button id="HomeButton" press="onHome" visible="false"\n\t\t\t\t\t\ticon="sap-icon://home"></Button>\n\t\t\t\t</contentLeft>\n\t\t\t\t<contentMiddle>\n\t\t\t\t\t<Label text="{i18n>view.POfromPR.title}"></Label>\n\t\t\t\t</contentMiddle>\n\t\t\t</Bar>\n\t\t</customHeader>\n\n\t\t<content>\n\t\t\t<IconTabBar id="IconizedFilter" select="switchView"\n\t\t\t\tselectedKey="Released" expandable="false">\n\t\t\t\t<items>\n\t\t\t\t\t<IconTabFilter id="btnPRreleased" text="{i18n>view.POfromPR.approved}"\n\t\t\t\t\t\tkey="Released" icon="sap-icon://approvals" design="Horizontal"></IconTabFilter>\n\t\t\t\t\t<IconTabSeparator icon="sap-icon://process"></IconTabSeparator>\n\t\t\t\t\t<IconTabFilter id="btnPRassigned" text="{i18n>view.POfromPR.assigned}"\n\t\t\t\t\t\tkey="Assigned" count="Loading..." icon="sap-icon://supplier" design="Horizontal"></IconTabFilter>\n\t\t\t\t\t<IconTabSeparator icon="sap-icon://process"></IconTabSeparator>\n\t\t\t\t\t<IconTabFilter id="btnPOsimulated" text="{i18n>view.POfromPR.proposal}"\n\t\t\t\t\t\tkey="Simulated" icon="sap-icon://inspection" design="Horizontal"></IconTabFilter>\n\t\t\t\t\t<IconTabSeparator icon="sap-icon://process"></IconTabSeparator>\n\t\t\t\t\t<IconTabFilter id="btnPOcreated" text="{i18n>view.POfromPR.created}"\n\t\t\t\t\t\tkey="Created" icon="sap-icon://documents" design="Horizontal"></IconTabFilter>\n\t\t\t\t</items>\n\n\t\t\t\t<content>\n\t\t\t\t<ScrollContainer id="ScrollCont"\n\t\t\t\t\t\thorizontal="false" vertical="true">\n\t\t\t\t\t\t<content>\n\t\t\t\t\t\t\t<core.mvc:XMLView id="ui.s2p.mm.purord.fromrequisition.PR_Released_View"\n\t\t\t\t\t\t\t\tviewName="ui.s2p.mm.purord.fromrequisition.view.PR_List"></core.mvc:XMLView>\n\t\t\t\t\t\t</content>\n\t\t\t\t\t</ScrollContainer>\n\t\t\t\t</content>\n\n\t\t\t</IconTabBar>\n\t\t</content>\n\t</Page>\n</core:View>\n',"ui/s2p/mm/purord/fromrequisition/view/PR_Assigned.controller.js":function(){jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.util.Formatter");jQuery.sap.require("sap.ca.ui.utils.busydialog");sap.ca.scfld.md.controller.BaseFullscreenController.extend("ui.s2p.mm.purord.fromrequisition.view.PR_Assigned",{onInit:function(){this.skip=0;this.packagesize=100;this.orderby="DeliveryDate desc";this.orderbyAttr="DeliveryDate";this.assignedPRs_all=0;this.assignedPRs_ui=0;this.oBundle=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle();this.bResponderOn=jQuery.sap.getUriParameters().get("responderOn");var l=this.oList=this.byId("pralist");this.oTableModel=new sap.ui.model.json.JSONModel();this.oAutoAssignModel=new sap.ui.model.json.JSONModel();var b=sap.ui.getCore().getEventBus();b.subscribe("ui.s2p.mm.purord.fromrequisition.publish","assignedPRs",this.receiveAssignedPRs,this);b.subscribe("ui.s2p.mm.purord.fromrequisition.publish","assignedBackendPRs",this.receiveAssBackendPRs,this);b.subscribe("ui.s2p.mm.purord.fromrequisition.popup","selection",this.receiveSelection,this);b.subscribe("ui.s2p.mm.purord.fromrequisition.trigger","loadAssignedPRs",this.loadAssignedPRs,this);this.poSimulatedCount=0;if(this.bResponderOn){var p="/ui.s2p.mm.purord.fromrequisition/mock/unassignedPRsLikeMockup.json";this.oTableModel.loadData(p,"",true);if(l){l.setModel(this.oTableModel,"PR_ass_model");var t=this.byId("listitem");if(t){l.bindItems("/PRItemCollectionAss",t)}}}},onBeforeRendering:function(){if(this.bResponderOn){}else{if(this.oAutoAssignModel.oData&&this.oAutoAssignModel.oData.PRItemCollection&&this.oAutoAssignModel.oData.PRItemCollection.length>0){jQuery.merge(this.oTableModel.oData.PRItemCollection,this.oAutoAssignModel.oData.PRItemCollection);this.oAutoAssignModel.setData({"PRItemCollection":[]});this.refreshList()}}},removeItemsFromModels:function(p,l){for(var i=0;i<l.length;i++){p.splice(l[i],1)}},removeSelectionFromListItem:function(p){var I=this.oList.getSelectedItems();for(var i=0;i<I.length;i++){if(I[i].getCells()[0].getText()===p){this.oList.setSelectedItem(I[i],false);break}}},onCreatePOSimulated:function(e){var I=[];var c=undefined;var p=undefined;var P=[];function s(d,r){var S=undefined;var f=[];var b=undefined;var t=undefined;var n={results:[]};var g;var G=0;sap.ca.ui.utils.busydialog.releaseBusyDialog();for(b=0;b<d.results.length;++b){if(d.results[b].Error==""){n.results.push(d.results[b]);for(var h=0;h<d.results[b].POProposalItemCollection.results.length;++h){f.push(d.results[b].POProposalItemCollection.results[h].PRKey)}}}S=new sap.ui.model.json.JSONModel({results:[]});g=S.getData();if(g){g.results=n.results;for(b=0;b<g.results.length;++b){G++;g.results[b].PONumber=G;g.results[b].PONumberFormatted=G}S.setData(g,false);this.poSimulatedCount=g.results.length}sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.PO_Simulated").oParams.oModel=S;t=this.oTableModel.getData();var l=[];for(b=t.PRItemCollection.length-1;b>=0;b--){for(h=0;h<f.length;++h){if(t.PRItemCollection[b].PRKey==f[h]){var j=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPRItem(t.PRItemCollection[b].PRNumberFormatted,t.PRItemCollection[b].PRItemFormatted);this.removeSelectionFromListItem(j);l.push(b);break}}}this.removeItemsFromModels(t.PRItemCollection,l);if(this.oList){this.oTableModel.refresh();this.oList.setModel(null);this.oList.setModel(this.oTableModel,"PR_ass_model")}var m=n.results.length;var q=this.previousSimulationPRItemCounter+this.selectedPRItemCounter;var M="";if(m==1){M=this.oBundle.getText("view.POfromPR_Messages.create_sing1",[q])}else{M=this.oBundle.getText("view.POfromPR_Messages.create_plu",[this.poSimulatedCount,q])}jQuery.sap.require("sap.m.MessageToast");sap.m.MessageToast.show(M,{width:"30em",duration:6000});sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_posimulated:this.poSimulatedCount,});this.assignedPRs_all-=this.selectedPRItemCounter;this.assignedPRs_ui-=this.selectedPRItemCounter;sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prassigned:this.assignedPRs_all,count_loaded:this.assignedPRs_ui})};function a(E){sap.ca.ui.utils.busydialog.releaseBusyDialog();var d="";var m=this.oBundle.getText('view.POfromPR.general_error_simulate_message');if((E.message&&E.response)){d=E.message+"\n"+E.response.requestUri+"\n"+E.response.statusText}ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage(m,d)};if(this.oList){I=this.oList.getSelectedItems()}this.selectedPRItemCounter=0;for(var i=0;i<I.length;i++){c=I[i].getBindingContext("PR_ass_model");if(!c.getProperty("Error")){P.push(c.getProperty("PRSourceKeys"));this.selectedPRItemCounter++}}this.previousSimulationPRItemCounter=0;var A=sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.PO_Simulated").oParams.oModel;if(A){var o=A.getData();for(var b=0;b<o.results.length;++b){var k=o.results[b].PRSourceKeys;if(k!=""){P.push(k);this.previousSimulationPRItemCounter+=o.results[b].POProposalItemCollection.results.length}}}p=P.join(",");var u="PRSourceKey="+"'"+p+"'";sap.ca.ui.utils.busydialog.requireBusyDialog();var B=this.oView.getModel();B.read("CreatePOProposal",null,[u,"$expand=POProposalItemCollection"],true,jQuery.proxy(s,this),jQuery.proxy(a,this))},refreshList:function(){if(this.oList){this.oList.setModel(null);this.oList.setModel(this.oTableModel,"PR_ass_model");this.oTableModel.refresh();if(this.orderbyAttr){ui.s2p.mm.purord.fromrequisition.Common.sortList(this.oList,this.orderbyAttr,true)}}},getList:function(){return this.byId("pralist")},receiveAssignedPRs:function(c,e,d){if(this.oAutoAssignModel.oData&&this.oAutoAssignModel.oData.PRItemCollection&&this.oAutoAssignModel.oData.PRItemCollection.length>0){jQuery.merge(this.oAutoAssignModel.oData.PRItemCollection,d.oModel.oData.PRItemCollection)}else{this.oAutoAssignModel=d.oModel}var i=d.oModel.oData.PRItemCollection.length;this.assignedPRs_all+=i;this.assignedPRs_ui+=i;sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prassigned:this.assignedPRs_all,count_loaded:this.assignedPRs_ui})},loadAssignedPRs:function(){if(this.oDataModel===undefined||this.oDataModel===null){this.oDataModel=this.oView.getModel("backendModel")}var s="$skip="+this.skip;var t="$top="+this.packagesize;var o="$orderby="+this.orderby;this.loadDataforView(s,t,o)},loadDataforView:function(s,t,o){var T=this.oBundle.getText("view.POfromPR.loading_assigned");if(this.oList){this.oList.setNoDataText(T)}sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prassigned:this.oBundle.getText("view.POfromPR.counter_loading")});this.oDataModel.read('PRItemCollection',null,[s,"$expand=SourcesOfSupplyCollection",t,o,"$filter=SupplierId ne '' "],true,jQuery.proxy(this.receiveAssBackendPRs,this),jQuery.proxy(function(e){sap.ca.ui.utils.busydialog.releaseBusyDialog();var d="";var m=this.oBundle.getText('view.POfromPR.general_error_assigned_message');if(this.oList){this.oList.setNoDataText(m)}if(e.message&&e.response){d=e.message+"\n"+e.response.requestUri+"\n"+e.response.statusText}ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage(m,d)},this))},receiveAssBackendPRs:function(d,r){if(this.oList){this.oList.setNoDataText("")}this.assignedPRs_all=parseInt(d.__count);this.assignedPRs_ui+=d.results.length;var e=null;jQuery.each(d.results,function(k,v){v.SupplierMultiple=false;v.ItemSelected=true;if(v.SourcesOfSupplyCollection&&v.SourcesOfSupplyCollection.results&&v.SourcesOfSupplyCollection.results.length===1){v.Error=v.SourcesOfSupplyCollection.results[0].Error;e=true}});this.oTableModel.setData({"PRItemCollection":d.results});this.refreshList();sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prassigned:this.assignedPRs_all,count_loaded:this.assignedPRs_ui});if(e){sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRassignedColor:sap.ui.core.IconColor.Negative})}else{sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRassignedColor:sap.ui.core.IconColor.Positive})}},receiveSelection:function(c,e,d){if(d.sOrigin==="PR_List"){if(this.oAutoAssignModel.oData&&this.oAutoAssignModel.oData.PRItemCollection){jQuery.merge(this.oAutoAssignModel.oData.PRItemCollection,[d.oPRItem])}else{this.oAutoAssignModel.setData({"PRItemCollection":[d.oPRItem]})}this.assignedPRs_all+=1;this.assignedPRs_ui+=1;sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prassigned:this.assignedPRs_all,count_loaded:this.assignedPRs_ui})}},onSupplierChange:function(e){if(!this.oSupplierPopup){if(this.oList){this.oSupplierPopup=ui.s2p.mm.purord.fromrequisition.Common.getSupplierPopup(this.oTableModel,this.getView().getModel("i18n"),this.oRouter);this.oSupplierPopup.sOrigin="PR_Assigned";this.oSupplierPopup.setTitle(this.oBundle.getText("view.POfromPR.assign_tit"))}}if(!this.oSupplierPopup){return}var s='';var p=e.getSource().getBindingContext("PR_ass_model").getPath();if(this.bResponderOn){s=p+"/SourcesOfSupplyCollection"}else{s=p+"/SourcesOfSupplyCollection/results"}var b=sap.ui.getCore().getEventBus();b.publish("ui.s2p.mm.purord.fromrequisition.supplier","path",{path:s,itempath:p,backendModel:this.oList.getModel("PR_ass_model"),});this.oSupplierPopup.openBy(e.getSource())},onSupplierLink:function(e){var c=e.getSource().getBindingContext("PR_ass_model");var s=c.getProperty("SupplierId");if(s===""){var p=c.getProperty("SupplyingPlantDescription");var i=this.oBundle.getText("view.PR_Assigned.sos_plant",[p]);var l=new sap.m.Label();l.addStyleClass("sapMContainerMargin");if(!this.oPlantPopup){var t=this.oBundle.getText("view.PO_List.plant");this.oPlantPopup=new sap.m.Popover({title:t,placement:sap.m.PlacementType.Right,content:l})}this.oPlantPopup.getContent()[0].setText(i);this.oPlantPopup.openBy(e.getSource())}else{this.oRouter.navTo("supplier",{supplierId:c.getProperty("SupplierId"),companyCode:c.getProperty("CompanyCode"),purchasingOrganization:c.getProperty("PurchasingOrganization")})}},onErrorShow:function(){var m=this.oBundle.getText("view.PR_List.no_price");ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage(m)},onPRItem:function(e){var c=e.getSource().getBindingContext("PR_ass_model");var p=c.getProperty("PRKey");sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item").oParams.sCallerId=e.getSource().getId();sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item").oParams.sPath=c.getPath();sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item").oParams.oList=e.getSource().getParent().getParent().getBinding("items").aIndices;this.oRouter.navTo("pr_Item",{prKey:p})},exceptionFormatter:function(e){return(e)?"sap-icon://alert":""},exceptionColorFormatter:function(e){return(e)?sap.ui.core.theming.Parameters.get("sapUiNegative"):undefined},formatSourceOfSupply:function(s,p){return(s)?s:p},getVSDialogSort:function(){var t=this;if(t.oVSDialog){return t.oVSDialog}var v=new sap.m.ViewSettingsDialog({sortItems:[new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_id"),key:"PRKey",selected:true}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_supp"),key:"SupplierName"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_mat"),key:"ProductDescription"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_delivery"),key:"DeliveryDate"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_val"),key:"Value"})],confirm:function(e){var p=e.getParameters();var B=t.oList.getBinding("items");var s=p.sortItem.getKey();var d=p.sortDescending;var S=new sap.ui.model.Sorter(s,d);if(s=="Value"){S.fnCompare=function(a,b){var V=parseFloat(a);var c=parseFloat(b);if(V<c){return-1}if(V>c){return 1}return 0}}B.sort(S)},});t.oVSDialog=v;return v}})},"ui/s2p/mm/purord/fromrequisition/view/PR_Assigned.view.xml":'<!--\n\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\n\n-->\n<core:View xmlns:core="sap.ui.core" xmlns="sap.m"\n\txmlns:layout="sap.ui.layout" controllerName="ui.s2p.mm.purord.fromrequisition.view.PR_Assigned">\n\n\n\t<!-- purchase requisition list with assigned suppliers -->\n\t<Table id="pralist" mode="MultiSelect" items="{PR_ass_model>/PRItemCollection}"\n\t\tinset="false">\n\n\t\t<!-- column descriptions -->\n\t\t<columns>\n\t\t\t<!-- ID column -->\n\t\t\t<Column id="column1" width="14%">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="l1" text="{i18n>view.PR_List.column_id}" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- the exception column -->\n\t\t\t<Column id="column0" width="4%" visible="true">\n\t\t\t</Column>\n\t\t\t<!-- Assigned Supplier column -->\n\t\t\t<Column id="column3" width="17%">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="l3" text="{i18n>view.PR_List.column_supp}" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- the edit Icon column -->\n\t\t\t<Column id="column3a" width="3%" visible="true"></Column>\n\t\t\t<!-- Material -->\n\t\t\t<Column id="column4" width="25%">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="l4" text="{i18n>view.PR_List.column_mat}" wrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Delivery Date -->\n\t\t\t<Column id="column5" width="15%" hAlign="End" minScreenWidth="large"\n\t\t\t\tdemandPopin="true">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="l5" text="{i18n>view.PR_List.column_delivery}"\n\t\t\t\t\t\twrapping="true" textAlign="End"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t\t<!-- Value -->\n\t\t\t<Column id="column6" hAlign="End">\n\t\t\t\t<header>\n\t\t\t\t\t<Text id="l6" text="{i18n>view.PR_List.column_val}" textAlign="End"\n\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t</header>\n\t\t\t</Column>\n\t\t</columns>\n\n\n\t\t<items>\n\t\t\t<ColumnListItem id="listitem" selected="{PR_ass_model>ItemSelected}">\n\t\t\t\t<cells>\n\t\t\t\t\t<!-- purchase req (items?) -->\n\t\t\t\t\t<Link id="prnr" press="onPRItem"\n\t\t\t\t\t\ttext="{parts:[{path:\'PR_ass_model>PRNumberFormatted\'},{path:\'PR_ass_model>PRItemFormatted\'}], formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPRItem\'}"></Link>\n\t\t\t\t\t<!-- error icon for error -->\n\t\t\t\t\t<core:Icon id="err" press="onErrorShow" size="1.375em"\n\t\t\t\t\t\tsrc="{ path:\'PR_ass_model>Error\', formatter: \'.exceptionFormatter\' }" color="{path:\'PR_ass_model>Error\', formatter: \'.exceptionColorFormatter\' }"></core:Icon>\n\t\t\t\t\t<!-- supplier -->\n\t\t\t\t\t<layout:HorizontalLayout>\n\t\t\t\t\t\t<layout:content>\n\t\t\t\t\t\t\t<Link id="supp" press="onSupplierLink"\n\t\t\t\t\t\t\t\ttext="{parts:[{path:\'PR_ass_model>SupplierName\'},{path:\'PR_ass_model>SupplyingPlantDescription\'}], formatter:\'.formatSourceOfSupply\'}"></Link>\n\t\t\t\t\t\t</layout:content>\n\t\t\t\t\t</layout:HorizontalLayout>\n\t\t\t\t\t<layout:VerticalLayout id="vmult" visible="{PR_ass_model>SupplierMultiple}">\n\t\t\t\t\t\t<layout:content>\n\t\t\t\t\t\t\t<core:Icon id="mult" press="onSupplierChange" src="sap-icon://edit"></core:Icon>\n\t\t\t\t\t\t</layout:content>\n\t\t\t\t\t</layout:VerticalLayout>\n\n\t\t\t\t\t<!-- material -->\n\t\t\t\t\t<layout:VerticalLayout>\n\t\t\t\t\t\t<layout:content>\n\t\t\t\t\t\t\t<Text id="matinfo"\n\t\t\t\t\t\t\t\ttext="{parts:[{path : \'PR_ass_model>ProductDescription\'},{path: \'PR_ass_model>ProductID\'}], \n                                   formatter : \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatItemDesc\'}"></Text>\n\t\t\t\t\t\t\t<Text id="quantity"\n\t\t\t\t\t\t\t\ttext="{parts:[ {path:\'PR_ass_model>OpenQuantityFormatted\'},\n\t\t\t\t\t                       {path:\'PR_ass_model>OpenQuantityUnitDescription\'}], \n\t\t\t\t                   formatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatMatQuantity\'}"></Text>\n\n\t\t\t\t\t\t\t<Text id="priceperquantity"\n\t\t\t\t\t\t\t\ttext="{parts:[ {path:\'PR_ass_model>Price\'}, \n\t\t\t\t\t\t\t\t\t\t    {path:\'PR_ass_model>Currency\'},\n\t\t\t\t\t\t\t\t\t\t    {path:\'PR_ass_model>PriceUnit\'},\n\t\t\t\t\t\t\t\t\t\t    {path:\'PR_ass_model>OrderPriceUnitDescription\'}], \n\t\t\t\t\t                   formatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatUnitPrice\'}"></Text>\n\t\t\t\t\t\t</layout:content>\n\t\t\t\t\t</layout:VerticalLayout>\n\t\t\t\t\t<!-- shipping/delivery -->\n\t\t\t\t\t<layout:VerticalLayout>\n\t\t\t\t\t\t<layout:content>\n\t\t\t\t\t\t\t<Text id="shipdate" textAlign="End"\n\t\t\t\t\t\t\t\ttext="{path:\'PR_ass_model>DeliveryDate\', \n                                       formatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatDateShort\' }">\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t<Text id="place" textAlign="End" text="{PR_ass_model>ShipToPlantDescription1}"></Text>\n\t\t\t\t\t\t</layout:content>\n\t\t\t\t\t</layout:VerticalLayout>\n\n\t\t\t\t\t<!-- value -->\n\t\t\t\t\t<ObjectNumber\n\t\t\t\t\t\tnumber="{path:\'PR_ass_model>Value\', formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.lazyFormatNumber\'}"\n\t\t\t\t\t\tunit="{PR_ass_model>Currency}">\n\t\t\t\t\t</ObjectNumber>\n\t\t\t\t</cells>\n\t\t\t</ColumnListItem>\n\t\t</items>\n\n\n\t</Table>\n</core:View>',"ui/s2p/mm/purord/fromrequisition/view/PR_List.controller.js":function(){jQuery.sap.require("sap.ui.core.IconPool");jQuery.sap.require("ui.s2p.mm.purord.fromrequisition.util.Formatter");jQuery.sap.require("sap.ui.model.odata.Filter");jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");jQuery.sap.require("sap.ca.ui.utils.busydialog");sap.ca.scfld.md.controller.BaseFullscreenController.extend("ui.s2p.mm.purord.fromrequisition.view.PR_List",{onInit:function(){this.skip=0;this.packagesize=50;this.orderby="DeliveryDate desc";this.approvedPRs_all=0;this.approvedPRs_ui=0;this.oBundle=this.oApplicationImplementation.getResourceBundle();this.bResponderOn=jQuery.sap.getUriParameters().get("responderOn");this.bExceptionFilter=false;this.oList=this.byId("prlist");this.bWorkaround=true;this.oTableModel=new sap.ui.model.json.JSONModel();this.oTableModel.setSizeLimit(500);this.aFilter=[];var b=sap.ui.getCore().getEventBus();b.subscribe("ui.s2p.mm.purord.fromrequisition.popup","selection",this.receiveSelection,this);b.subscribe("ui.s2p.mm.purord.fromrequisition.publish","count",this.updateButtonText,this);if(this.bResponderOn){var p="/ui.s2p.mm.purord.fromrequisition/mock/unassignedPRsLikeMockup.json";this.oTableModel.loadData(p,"",true);if(this.oList){this.oList.setModel(this.oTableModel,"PR_appr_model")}}this.setTableHeader()},onBeforeRendering:function(){if(!this.oList){return}var l=this.oList.getModel("PR_appr_model");if(l===undefined&&this.bWorkaround){this.bWorkaround=false;this.oModel=this.oView.getModel("backendModel");var s="$skip="+this.skip;var t="$top="+this.packagesize;var o="$orderby="+this.orderby;var m=true;this.loadDataforView(s,t,o,m);sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.trigger","loadAssignedPRs");if(jQuery.device.is.phone){var a=this.oApplicationImplementation.getResourceBundle().getText('view.POfromPR.phone_warning');ui.s2p.mm.purord.fromrequisition.Common.ShowWarningMessage(a,"")}}},loadDataforView:function(s,t,o,m){if(!this.oList){return}var S;if(m===true){S=this.addToTableModel}else{S=this.refreshTableModel}this.oList.setNoDataText(this.oBundle.getText("view.POfromPR.loading_message"));sap.ca.ui.utils.busydialog.requireBusyDialog();this.oModel.read('PRItemCollection',null,[s,t,o,"$filter=SupplierId eq '' "],true,jQuery.proxy(S,this),jQuery.proxy(function(e){sap.ca.ui.utils.busydialog.releaseBusyDialog();var a=this.oBundle.getText('view.POfromPR.general_error_unassigned_message');this.oList.setNoDataText(a);var d="";if(e.message&&e.response){d=e.message+"\n"+e.response.requestUri+"\n"+e.response.statusText}ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage(a,d)},this))},addToTableModel:function(d,r){var m=true;this.updateTableModel(d,r,m)},refreshTableModel:function(d,r){var m=false;this.updateTableModel(d,r,m)},updateTableModel:function(d,r,m){var c=this.byId("column2");var l=this.byId("l1");var a=undefined;if(l){a=l.getDomRef()}if(c&&a){c.setMinScreenWidth((a.clientWidth+1)+"px")}sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","orientationChange",this);if(this.approvedPRs_all===0){this.approvedPRs_all=parseInt(d.__count)}if(m===true){this.approvedPRs_ui+=d.results.length}else{this.approvedPRs_ui=d.results.length}sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prapproved:this.approvedPRs_all,count_loaded:this.approvedPRs_ui});jQuery.each(d.results,function(k,v){v.SupplierMultiple=false;v.HideMe=false;v.ItemSelected=true});sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRreleasedColor:sap.ui.core.IconColor.Default});if(this.oTableModel.oData.PRItemCollection&&this.oTableModel.oData.PRItemCollection.length>0&&m===true){this.toggleListVisibility(true);jQuery.merge(this.oTableModel.oData.PRItemCollection,d.results)}else if(d.results.length==0&&(!this.oTableModel.oData.PRItemCollection||this.oTableModel.oData.PRItemCollection.length==0)){this.toggleListVisibility(false);sap.ca.ui.utils.busydialog.releaseBusyDialog();return}else{this.toggleListVisibility(true);this.oTableModel.setData({"PRItemCollection":d.results})}if(this.oList){this.oList.setModel(this.oTableModel,"PR_appr_model");this.oTableModel.refresh();sap.ca.ui.utils.busydialog.releaseBusyDialog();this.oList.setNoDataText("");this.refreshList()}},getList:function(){return this.byId("prlist")},onAssignSupplier:function(e){var I=[];if(this.oList){I=this.oList.getSelectedItems()}var r="";var p="";var c;var b=[];for(var i=0;i<I.length;i++){r="";c=I[i].getBindingContext("PR_appr_model");p=c.getProperty("PRKey");r="PRItemCollection('"+p+"')?$expand=SourcesOfSupplyCollection";b.push(this.oModel.createBatchOperation(r,"GET"))}if(b.length>0){sap.ca.ui.utils.busydialog.requireBusyDialog({text:this.oBundle.getText("view.POfromPR.assigning_message")});this.oModel.addBatchReadOperations(b);this.oModel.refreshSecurityToken(jQuery.proxy(this.callBatchAssignSuppliers,this),function(a){sap.ca.ui.utils.busydialog.releaseBusyDialog();ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage("error refresh csrf token",a)},true)}},callBatchAssignSuppliers:function(){this.oModel.submitBatch(jQuery.proxy(this.getAssignResult,this),function(e){jQuery.sap.log.info(e.toString());jQuery.sap.log.info("error submit batch");sap.ca.ui.utils.busydialog.releaseBusyDialog();var m=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('view.POfromPR.general_error_assign_message');var d="";if(e.message&&e.response){d=e.message+"\n"+e.response.requestUri+"\n"+e.response.statusText}ui.s2p.mm.purord.fromrequisition.Common.ShowErrorMessage(m,d)},true)},getIfItemInList:function(p,I){for(var i=0;i<I.length;i++){var P=ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPRItem(p.PRNumberFormatted,p.PRItemFormatted);if(P===I[i].getCells()[0].getText()){return i}}return-1},getAssignResult:function(d,r,e){var I=[];var n=[];var R=[];var a=[];var m=0;var N=0;var A=0;var s;jQuery.each(d.__batchResponses,function(k,v){v.data.SupplierMultiple=false;v.data.HideMe=false;v.data.ItemSelected=true;s=0;if(v.data.SourcesOfSupplyCollection.results){s=v.data.SourcesOfSupplyCollection.results.length}if(s>1){v.data.SupplierMultiple=true;m+=1}else if(s===1){if(v.data.SourcesOfSupplyCollection.results[0].FixedVendor===""||v.data.SourcesOfSupplyCollection.results[0].Error===true){v.data.Error=true;N+=1}else{v.data.PRSourceKeys=v.data.SourcesOfSupplyCollection.results[0].PRSourceKeys;v.data.SupplierId=v.data.SourcesOfSupplyCollection.results[0].FixedVendor;v.data.SupplierName=v.data.SourcesOfSupplyCollection.results[0].FixedVendorName;v.data.OpenQuantityUnit=v.data.SourcesOfSupplyCollection.results[0].OpenQuantityUnit;v.data.OpenQuantityUnitDescription=v.data.SourcesOfSupplyCollection.results[0].OpenQuantityUnitDescription;v.data.OpenQuantity=v.data.SourcesOfSupplyCollection.results[0].OpenQuantity;v.data.OpenQuantityFormatted=v.data.SourcesOfSupplyCollection.results[0].OpenQuantityFormatted;v.data.Price=v.data.SourcesOfSupplyCollection.results[0].NetPrice;v.data.PriceFormatted=v.data.SourcesOfSupplyCollection.results[0].NetPriceFormatted;v.data.Value=v.data.SourcesOfSupplyCollection.results[0].NetOrderValue;v.data.ValueFormatted=v.data.SourcesOfSupplyCollection.results[0].NetOrderValueFormatted;v.data.Currency=v.data.SourcesOfSupplyCollection.results[0].Currency;v.data.PriceUnit=v.data.SourcesOfSupplyCollection.results[0].PriceUnit;v.data.OrderPriceUnit=v.data.SourcesOfSupplyCollection.results[0].OrderPriceUnit;v.data.OrderPriceUnitDescription=v.data.SourcesOfSupplyCollection.results[0].OrderPriceUnitDescription;v.data.PurchasingOrganization=v.data.SourcesOfSupplyCollection.results[0].PurchasingOrg;v.data.HideMe=true;a.push(v.data);A+=1}}else{N+=1}R.push(v.data)});sap.ca.ui.utils.busydialog.releaseBusyDialog();var l=this.oTableModel.oData.PRItemCollection.length;if(this.oList){I=this.oList.getItems()}for(var i=0;i<l;i++){var b=this.getIfItemInList(this.oTableModel.oData.PRItemCollection[i],I);if(b!=-1){if(I[b].getSelected()){for(var j=0,f=false;!f&&j<R.length;j++){if(this.oTableModel.oData.PRItemCollection[i].PRKey===R[j].PRKey){n.push(R[j]);f=true}}}else{n.push(this.oTableModel.oData.PRItemCollection[i])}}else{this.oTableModel.oData.PRItemCollection[i].HideMe=true;n.push(this.oTableModel.oData.PRItemCollection[i])}}if(a.length>0){var o=new sap.ui.model.json.JSONModel();o.setData({"PRItemCollection":a});sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","assignedPRs",{oModel:o})}this.oTableModel.setData({"PRItemCollection":n});if(this.oList){this.oList.setModel(null);this.oList.setModel(this.oTableModel,"PR_appr_model");this.oTableModel.refresh();this.refreshList()}this.approvedPRs_all-=A;this.approvedPRs_ui-=A;sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prapproved:this.approvedPRs_all,count_loaded:this.approvedPRs_ui});if(N>0){sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRreleasedColor:sap.ui.core.IconColor.Negative})}else if(m>0){sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRreleasedColor:sap.ui.core.IconColor.Critical})}else{sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRreleasedColor:sap.ui.core.IconColor.Default})}var M="";var c="";var g="";if(m>0){M=m===1?this.oBundle.getText("view.POfromPR_Messages.assign_manual_sing"):this.oBundle.getText("view.POfromPR_Messages.assign_manual_plu",[m])}if(A>0){c=A===1?this.oBundle.getText("view.POfromPR_Messages.assigned_sing"):this.oBundle.getText("view.POfromPR_Messages.assigned_plu",[A])}if(N>0){g=N===1?this.oBundle.getText("view.POfromPR_Messages.not_assigned_sing"):this.oBundle.getText("view.POfromPR_Messages.not_assigned_plu",[N])}var h=M+'\n'+c+'\n'+g;jQuery.sap.require("sap.m.MessageToast");sap.m.MessageToast.show(h,{width:"30em",duration:6000})},onMultipleSupplier:function(e){var t;var d;if(!this.oSupplierPopup){this.oSupplierPopup=ui.s2p.mm.purord.fromrequisition.Common.getSupplierPopup(this.oTableModel,this.getView().getModel("i18n"),this.oRouter);this.oSupplierPopup.sOrigin="PR_List"}if(!this.oSupplierPopup){return}var c=e.getSource().getBindingContext("PR_appr_model");var p=c.getPath();var E=c.getProperty(p+"/Error");if(E){t=this.oBundle.getText("XTIT_MS_ERROR");d=this.oBundle.getText("view.PR_List.no_price")}else{t=this.oBundle.getText("view.POfromPR.assign_tit");d=this.oBundle.getText("view.MultipleSuppliers.title")}this.oSupplierPopup.setTitle(t);var s=undefined;if(this.bResponderOn){s=p+"/SourcesOfSupplyCollection"}else{s=p+"/SourcesOfSupplyCollection/results"}var b=sap.ui.getCore().getEventBus();b.publish("ui.s2p.mm.purord.fromrequisition.supplier","path",{path:s,itempath:p,backendModel:this.oList.getModel("PR_appr_model"),displayText:d});this.oSupplierPopup.openBy(e.getSource())},receiveSelection:function(c,e,d){if(!this.oList){return}if(d.sOrigin==="PR_List"){var n=[];var l=this.oTableModel.oData.PRItemCollection.length;var h=false;for(var i=0;i<l;i++){if(this.oTableModel.oData.PRItemCollection[i].PRKey===d.oPRItem.PRKey){this.oTableModel.oData.PRItemCollection[i].HideMe=true;this.oTableModel.oData.PRItemCollection[i].ItemSelected=true}else if(this.oTableModel.oData.PRItemCollection[i].AssignedSupplierCount>1&&!this.oTableModel.oData.PRItemCollection[i].HideMe===true){h=true}n.push(this.oTableModel.oData.PRItemCollection[i])}this.oTableModel.setData({"PRItemCollection":n});if(this.oList){this.oList.setModel(this.oTableModel,"PR_appr_model");this.refreshList()}this.approvedPRs_all-=1;this.approvedPRs_ui-=1;sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","count",{count_prapproved:this.approvedPRs_all,count_loaded:this.approvedPRs_ui});if(h==true){sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRreleasedColor:sap.ui.core.IconColor.Critical})}else{sap.ui.getCore().getEventBus().publish("ui.s2p.mm.purord.fromrequisition.publish","updateIconTabColor",{btnPRreleasedColor:sap.ui.core.IconColor.Default})}}},onLoadMoreData:function(e){if(this.oModel&&this.oModel.read){this.skip+=this.packagesize;var s="$skip="+this.skip;var t="$top="+this.packagesize;var o="$orderby="+this.orderby;var m=true;this.loadDataforView(s,t,o,m)}},filterValue:function(f){var F;switch(f){case"noFilter":this.bExceptionFilter=false;this.aFilter=[];break;case"withException":this.bExceptionFilter=true;F=new sap.ui.model.Filter("SupplierMultiple",sap.ui.model.FilterOperator.EQ,true);this.aFilter=[F];break;case"withoutException":this.bExceptionFilter=true;F=new sap.ui.model.Filter("SupplierMultiple",sap.ui.model.FilterOperator.EQ,false);this.aFilter=[F];break}this.refreshList()},updateButtonText:function(c,e,d){if(d.count_prapproved){var b=this.byId("btnLoad");var t=this.oBundle.getText("view.POfromPR.load_more");t+=" [ "+d.count_loaded+" / "+d.count_prapproved+" ] ";if(b){b.setText(t)}}},exceptionFormatter:function(a,e){var i="";if(e){i="sap-icon://alert"}else{var s=parseInt(a);if(s>=1){i="sap-icon://warning2"}}return i},exceptionColorFormatter:function(a,e){var c=undefined;var s=parseInt(a);if(e){c=sap.ui.core.theming.Parameters.get("sapUiNegative")}else{if(s>=1){c=sap.ui.core.theming.Parameters.get("sapUiCritical")}}return c},exceptionClassFormatter:function(a,e){var c="";var s=parseInt(a);if(e){c="sapMITFilterNegative"}else{if(s>=1){c="sapMITFilterCritical"}}return c},refreshList:function(){if(!this.oList){return}var l=this.oList.getBinding("items");var f=new sap.ui.model.Filter("HideMe",sap.ui.model.FilterOperator.EQ,false);var F=[];F.push(f);if(this.aFilter.length>0){jQuery.merge(F,this.aFilter)}if(l){l.filter(F,sap.ui.model.FilterType.Control)}},toggleListVisibility:function(v){if(this.oList){this.oList.setVisible(v)}var s=this.byId("ShowMore");if(s){s.setVisible(v)}var n=this.byId("NoData");if(n){n.setVisible(!v)}},onPRItem:function(e){var c=e.getSource().getBindingContext("PR_appr_model");var p=c.getProperty("PRKey");sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item").oParams.sCallerId=e.getSource().getId();sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item").oParams.sPath=c.getPath();sap.ui.controller("ui.s2p.mm.purord.fromrequisition.view.FS_PR_Item").oParams.oList=e.getSource().getParent().getParent().getBinding("items").aIndices;this.oRouter.navTo("pr_Item",{prKey:p})},setTableHeader:function(){var v=this.getVSDialogFilter();this.oList.setInfoToolbar(new sap.m.Toolbar({active:true,visible:false,press:function(e){v.open()},content:[new sap.m.Label({text:"?"}),new sap.m.ToolbarSpacer(),new sap.ui.core.Icon({src:"sap-icon://add-filter"})]}))},getVSDialogSort:function(){var t=this;if(t.oVSDialogSort){return t.oVSDialogSort}var v=new sap.m.ViewSettingsDialog({sortItems:[new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_id"),key:"PRKey",selected:true}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.POfromPR.filte_exceptions"),key:"SupplierMultiple"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_reldate"),key:"ReleaseDate"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_mat"),key:"ProductDescription"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_delivery"),key:"DeliveryDate"}),new sap.m.ViewSettingsItem({text:t.oBundle.getText("view.PR_List.column_val"),key:"Value"})],confirm:function(e){var p=e.getParameters();var B=t.oList.getBinding("items");var s=p.sortItem.getKey();var d=p.sortDescending;if(t.approvedPRs_all===t.approvedPRs_ui){var S=new sap.ui.model.Sorter(s,d);if(s=="Value"){S.fnCompare=function(a,b){var V=parseFloat(a);var f=parseFloat(b);if(V<f){return-1}if(V>f){return 1}return 0}}B.sort(S)}else{var c="$skip=0";var T="$top=50";t.orderbyAttr=s;if(d===true){t.orderby=t.orderbyAttr+" desc"}else{t.orderby=s}var o="$orderby="+t.orderby;var m=false;t.loadDataforView(c,T,o,m)}},});t.oVSDialogSort=v;return v},getVSDialogFilter:function(){var t=this;if(t.oVSDialogFilter){return t.oVSDialogFilter}var v=new sap.m.ViewSettingsDialog({presetFilterItems:[new sap.m.ViewSettingsFilterItem({text:t.oBundle.getText("view.POfromPR.filte_exceptions"),key:"withException",multiSelect:false,}),new sap.m.ViewSettingsFilterItem({text:t.oBundle.getText("view.POfromPR.filter_no_exceptions"),key:"withoutException",multiSelect:false,})],confirm:function(e){var p=e.getParameters();var T=false;if(!p.presetFilterItem){t.filterValue("noFilter")}else{var f=p.presetFilterItem.getKey();t.filterValue(f);T=true}var F=t.oList.getInfoToolbar();F.setVisible(T);var o=F.getContent()[0];o.setText(p.filterString)},});t.oVSDialogFilter=v;return v},})},"ui/s2p/mm/purord/fromrequisition/view/PR_List.view.xml":'<!--\n\n    Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved\n\n-->\n<core:View xmlns:core="sap.ui.core" xmlns="sap.m"\n\txmlns:layout="sap.ui.layout" controllerName="ui.s2p.mm.purord.fromrequisition.view.PR_List">\n\n\t<layout:VerticalLayout width="100%">\n\t\t<layout:content>\n\t\t\t<!-- purchase requisition list as table / the unassigned ones (no supplier) -->\n\t\t\t<Table id="prlist" mode="MultiSelect"\n\t\t\t\tnoDataText="{i18n>view.POfromPR.general_error_unassigned_message}"\n\t\t\t\titems="{PR_appr_model>/PRItemCollection}" inset="false" visible="true">\n\t\t\t\t<!-- column descriptions -->\n\t\t\t\t<columns>\n\t\t\t\t\t<Column id="column1" hAlign="Begin">\n\t\t\t\t\t\t<header>\n\t\t\t\t\t\t\t<Text id="l1" text="{i18n>view.PR_List.column_id}" wrapping="true"></Text>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<!-- the exception column -->\n\t\t\t\t\t<Column id="column0" width="4%" hAlign="Begin"></Column>\n\t\t\t\t\t<Column id="column2" width="14%" hAlign="Begin"\n\t\t\t\t\t\tminScreenWidth="large" demandPopin="true">\n\t\t\t\t\t\t<header>\n\t\t\t\t\t\t\t<Text id="l2" text="{i18n>view.PR_List.column_reldate}"\n\t\t\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column id="column4" width="29%">\n\t\t\t\t\t\t<header>\n\t\t\t\t\t\t\t<Text id="l4" text="{i18n>view.PR_List.column_mat}"\n\t\t\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column id="column5" width="16%" hAlign="End">\n\t\t\t\t\t\t<header>\n\t\t\t\t\t\t\t<Text id="l5" text="{i18n>view.PR_List.column_delivery}"\n\t\t\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t</Column>\n\t\t\t\t\t<Column id="column6" hAlign="End">\n\t\t\t\t\t\t<header>\n\t\t\t\t\t\t\t<Text id="l6" text="{i18n>view.PR_List.column_val}"\n\t\t\t\t\t\t\t\twrapping="true"></Text>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t</Column>\n\t\t\t\t</columns>\n\t\t\t\t<!-- column list item cells -->\n\t\t\t\t<items>\n\t\t\t\t\t<ColumnListItem id="listItem" selected="{PR_appr_model>ItemSelected}"\n\t\t\t\t\t\ttype="Inactive">\n\t\t\t\t\t\t<!-- cells -->\n\t\t\t\t\t\t<cells>\n\t\t\t\t\t\t\t<!-- PR Item -->\n\t\t\t\t\t\t\t<Link id="prnr" press="onPRItem"\n\t\t\t\t\t\t\t\ttext="{parts:[{path:\'PR_appr_model>PRNumberFormatted\'},{path:\'PR_appr_model>PRItemFormatted\'}], formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatPRItem\'}">\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t<!-- alert button, icon font e053 to use -->\n\t\t\t\t\t\t\t<core:Icon id="mult" press="onMultipleSupplier"\n\t\t\t\t\t\t\t\tcolor="{parts: [{path:\'PR_appr_model>AssignedSupplierCount\'}, {path: \'PR_appr_model>Error\'}], formatter: \'.exceptionColorFormatter\' }"\n\t\t\t\t\t\t\t\tsrc="{parts: [{path:\'PR_appr_model>AssignedSupplierCount\'}, {path: \'PR_appr_model>Error\'}], formatter: \'.exceptionFormatter\' }"\n\t\t\t\t\t\t\t\tsize="1.375em">\n\t\t\t\t\t\t\t</core:Icon>\n\t\t\t\t\t\t\t<!-- due date -->\n\t\t\t\t\t\t\t<Text id="ddate"\n\t\t\t\t\t\t\t\ttext="{path:\'PR_appr_model>ReleaseDate\', formatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatDateShort\' }"></Text>\n\t\t\t\t\t\t\t<!-- material -->\n\t\t\t\t\t\t\t<layout:VerticalLayout>\n\t\t\t\t\t\t\t\t<layout:content>\n\t\t\t\t\t\t\t\t\t<Text id="matinfo"\n\t\t\t\t\t\t\t\t\t\ttext="{parts:[{path:\'PR_appr_model>ProductDescription\'},{path:\'PR_appr_model>ProductID\'}],\n\t\t\t\t\t\t\t\t\t\t\t\t\tformatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatItemDesc\'}"></Text>\n\t\t\t\t\t\t\t\t\t<Text id="quantity"\n\t\t\t\t\t\t\t\t\t\ttext="{parts:[{path:\'PR_appr_model>OpenQuantityFormatted\'}, {path:\'PR_appr_model>OpenQuantityUnitDescription\'}],\n\t\t\t\t\t\t\t\t\t\t\t\t\tformatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatMatQuantity\'}"></Text>\n\t\t\t\t\t\t\t\t\t<Text id="priceperquantity"\n\t\t\t\t\t\t\t\t\t\ttext="{parts:[{path:\'PR_appr_model>Price\'},{path:\'PR_appr_model>Currency\'},{path:\'PR_appr_model>PriceUnit\'},\n\t\t\t\t\t\t\t\t\t\t\t\t\t{path:\'PR_appr_model>OrderPriceUnitDescription\'}],\n\t\t\t\t\t\t\t\t\t\t\t\t\tformatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatUnitPrice\'}"></Text>\n\t\t\t\t\t\t\t\t</layout:content>\n\t\t\t\t\t\t\t</layout:VerticalLayout>\n\t\t\t\t\t\t\t<!-- shipping/delivery -->\n\t\t\t\t\t\t\t<layout:VerticalLayout>\n\t\t\t\t\t\t\t\t<layout:content>\n\t\t\t\t\t\t\t\t\t<Text id="shipdate"\n\t\t\t\t\t\t\t\t\t\ttext="{path:\'PR_appr_model>DeliveryDate\', formatter: \'ui.s2p.mm.purord.fromrequisition.util.Formatter.formatDateShort\'}"></Text>\n\t\t\t\t\t\t\t\t\t<Text id="place" text="{PR_appr_model>ShipToPlantDescription1}"></Text>\n\t\t\t\t\t\t\t\t</layout:content>\n\t\t\t\t\t\t\t</layout:VerticalLayout>\n\t\t\t\t\t\t\t<!-- value -->\n\t\t\t\t\t\t\t<ObjectNumber\n\t\t\t\t\t\t\t\tnumber="{path:\'PR_appr_model>Value\', formatter:\'ui.s2p.mm.purord.fromrequisition.util.Formatter.lazyFormatNumber\'}"\n\t\t\t\t\t\t\t\tunit="{PR_appr_model>Currency}">\n\t\t\t\t\t\t\t</ObjectNumber>\n\n\t\t\t\t\t\t</cells>\n\t\t\t\t\t</ColumnListItem>\n\t\t\t\t</items>\n\n\t\t\t</Table>\n\t\t\t<!-- ShowMore Button -->\n\t\t\t<layout:HorizontalLayout class="EndOfListButton"\n\t\t\t\tid="ShowMore" visible="false">\n\t\t\t\t<layout:content>\n\t\t\t\t\t<Button id="btnLoad" press="onLoadMoreData" text="{i18n>view.POfromPR.load_more}"\n\t\t\t\t\t\ttype="Transparent"></Button>\n\t\t\t\t</layout:content>\n\t\t\t</layout:HorizontalLayout>\n\n\t\t\t<!-- No Data Design -->\n\t\t\t<layout:HorizontalLayout class="EndOfListButton"\n\t\t\t\tid="NoData" visible="false">\n\t\t\t\t<layout:content>\n\t\t\t\t\t<layout:VerticalLayout>\n\t\t\t\t\t\t<layout:content>\n\t\t\t\t\t\t\t<core:Icon src="sap-icon://competitor" size="13em"\n\t\t\t\t\t\t\t\tcolor="#007833"></core:Icon>\n\t\t\t\t\t\t\t<Text text="{i18n>view.PR_List.no_data}"></Text>\n\t\t\t\t\t\t</layout:content>\n\t\t\t\t\t</layout:VerticalLayout>\n\t\t\t\t</layout:content>\n\t\t\t</layout:HorizontalLayout>\n\n\t\t</layout:content>\n\n\t</layout:VerticalLayout>\n</core:View>\n'}});
